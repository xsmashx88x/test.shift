<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="shortcut icon" type="image/png" href="https://xsmashx88x.github.io/Shift-Codes/smashfavicon.png">
    <link rel="icon" type="image/png" href="https://xsmashx88x.github.io/Shift-Codes/smashfavicon.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SHiFT Codes - Tracker + More</title>
    
    <!-- Open Graph tags -->
    <meta property="og:title" content="Borderlands SHiFT Codes - Tracker + More">
    <meta property="og:description" content="Track and manage Borderlands SHiFT codes + More">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card tags -->
    <meta name="twitter:title" content="Borderlands SHiFT Codes - Tracker + More">
    <meta name="twitter:description" content="Track and manage Borderlands SHiFT codes + More">
  <body>

    <!-- === START: FINAL FLOATING INFO PANEL === -->
    <div class="floating-info-panel">
        
        <!-- This part is always visible -->
        <div class="visible-reminder-text">
            • FAV & CHECK DAILY • REFRESH OFTEN • 
            
            <!-- This is the smaller, clickable link that triggers the dropdown -->
            <a class="thank-you-link" onclick="toggleThankYouPanel(this)">
                • Supporters & Special Thanks | 10/4/2025 • <br> <small style="font-size: 0.7em;">Click To Open/Close list</small>
            </a>
        </div>
        
        <!-- This is the content that is hidden by default -->
        <div class="thank-you-content">
            <h4>A huge thank you to: (newest at top)</h4>
            <ul>
                <li>Sticky, For being a legend | 🫂</li>                
                <li>The amazing [/r/Borderlands] Community! | 🫂</li>
                <li>---------------------------------------------</li>
                <li>zeod! | Holy Thanks 🫂 🍵</li>
                <li>badvogonpoet! | Thanks 🫂 🍵</li>
                <li>Craig! | Thanks 🫂 🍵</li>
                <li>Dean! | 🍵</li>
                <li>LazrPanther! | 🍵</li>
                <li>Snowblindtiger! | 🍵</li>
                <li>Daniel! | 🍵</li>
                <li>LSandman24! | 🍵</li>
                <li>Primel91! | 🍵</li>
                <li>Playawhile! | 🍵</li>
                <li>Kura! | 🍵</li>
                <li>mDaro! | 🍵</li>
                <li>needlead! | 🍵</li>
                <li>Dan*** E****** (Wont Post Full Info)! | 🍵</li>
                <li>Kakkazan! | 🍵</li>
                <li>reddragun3! | 🍵</li>
                <!-- Add more names here -->
            </ul>
        </div>

    </div>
    <div class="noise"></div>
    <div class="scanlines"></div>
    
    <div class="container">
    <style>
        

        @import url('https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;600;700&display=swap');
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Chakra Petch', sans-serif;
            text-align: center;
            padding: 20px;
            background: #000000;
            color: #fff;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 20% 30%, #000000 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, #000000 0%, transparent 50%);
        }
        
        .container {
            max-width: 650px;
            margin: 0 auto;
            background: rgb(31 31 31);
            padding: 25px;
            border-radius: 5px;
            box-shadow: 0 0 15px rgba(255, 198, 0, 0.4);
            border: 2px solid #ffc600;
            position: relative;
            overflow: hidden;
        }
        
        .container:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #ffc600, #ff7c00, #ffc600);
            box-shadow: 0 0 10px #ffc600;
        }

/* ===== FAINT BACKGROUND IMAGE FOR ACTIVE CODES ===== */

/* 1. Prepare the main code box to contain a background layer */
.code-box {
    position: relative; /* This is crucial for positioning the background image */
    overflow: hidden;   /* This prevents the background image from spilling outside the box */
}

/* 2. Create a pseudo-element that will act as the background image layer */
.code-box::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;

    /* --- CUSTOMIZE YOUR IMAGE HERE --- */
    background-image: url('https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/activekeysv2.png'); /* URL to the Vault Symbol image */

    background-repeat: no-repeat;
    background-position: center;
    background-size: cover; /* 'contain' fits the whole image; 'cover' fills the whole box */
    
    /* --- MAKE IT FAINT --- */
    opacity: 0.1; /* Adjust between 0.0 (invisible) and 1.0 (fully visible) */
    
    z-index: 0; /* Places this layer behind the text and other content */
}

/* 3. Ensure the actual content (text, buttons, etc.) sits on top of the new background */
.code-box > * {
    position: relative;
    z-index: 1;
}

/* =================================================== */
/*    FAINT BACKGROUND IMAGES FOR OTHER CODE BOXES     */
/* =================================================== */

/* ===== 1. EXPIRED CODES ===== */
.expired-code-box {
    position: relative;
    overflow: hidden;
}
.expired-code-box::before {
    content: '';
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    /* --- CUSTOMIZE YOUR IMAGE HERE --- */
    background-image: url('https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/expiredcodes.png'); /* Suggested: Red/Cracked Vault Symbol */
    background-repeat: no-repeat;
    background-position: center;
    background-size: cover;
    opacity: 0.1; /* Very faint for expired boxes */
    z-index: 0;
}

/* ===== 2. BLACK MARKET CODES ===== */
.black-market-code-box {
    position: relative;
    overflow: hidden;
}
.black-market-code-box::before {
    content: '';
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    /* --- CUSTOMIZE YOUR IMAGE HERE --- */
    background-image: url('https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/blackmarketbgv1.png'); /* Suggested: Maurice Icon */
    background-repeat: no-repeat;
    background-position: center;
    background-size: cover;
    opacity: 0.1; /* Adjust faintness */
    z-index: 0;
}

/* ===== 3. PERMANENT/DROP CODES ===== */
.permanent-code-box {
    position: relative;
    overflow: hidden;
}
.permanent-code-box::before {
    content: '';
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    /* --- CUSTOMIZE YOUR IMAGE HERE --- */
    background-image: url('https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/dropskinsanmore.png'); /* Suggested: Diamond Key Icon */
    background-repeat: no-repeat;
    background-position: center;
    background-size: cover;
    opacity: 0.1; /* Adjust faintness */
    z-index: 0;
}

/* ===== 4. ENSURE CONTENT STAYS ON TOP (Apply to all boxes) ===== */
.expired-code-box > *,
.black-market-code-box > *,
.permanent-code-box > * {
    position: relative;
    z-index: 1;
}

/* =================================================== */
/*    MOBILE-SPECIFIC BACKGROUND IMAGE ADJUSTMENT      */
/* =================================================== */
/* When the screen is 768px wide or less, this code will run */
@media (max-width: 768px) {

  /* Target all the background image layers and change the size to 'contain' */
  .code-box::before,
  .expired-code-box::before,
  .black-market-code-box::before,
  .permanent-code-box::before {
    background-size: contain !important; /* Use 'contain' on mobile to ensure the whole image is visible */
  }

}

/* =================================================== */
/*        FINAL: INTERACTIVE FLOATING INFO PANEL       */
/* =================================================== */

/* --- 1. The Main Container --- */
/* This is the element that floats and contains everything */
.floating-info-panel {
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 1001;
    width: 330px; /* A fixed width often works well */
    
    background: rgba(20, 15, 25, 0.9);
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    border: 1px solid #ff7c00;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.6);
    
    text-align: center;
    transition: all 0.3s ease-in-out;
}

/* --- 2. The Always-Visible Text Block --- */
.visible-reminder-text {
    color: #ffc600;
    font-family: 'Chakra Petch', sans-serif;
    font-size: 12px;
    font-weight: 600;
    text-shadow: 1px 1px 1px #000;
    text-transform: uppercase;
    padding: 8px 12px;
    user-select: none;
    line-height: 1.0;
}

/* --- 3. The Smaller Clickable Link --- */
.thank-you-link {
    display: block; /* Makes it take its own line */
    margin-top: 5px; /* Space from the text above */
    color: #00ffff; /* A different color to show it's a special link */
    font-size: 12px;
    font-weight: 700;
    text-decoration: none;
    cursor: pointer;
    transition: color 0.2s ease;
    position: relative; /* Needed for the arrow */
}

.thank-you-link:hover {
    color: #fff;
}

/* --- 4. The Hidden Content (Default State) --- */
.thank-you-content {
    color: #ffcc88;
    font-size: 14px;
    line-height: 1.6;
    text-align: left;
    
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out, border 0.3s ease;
    padding: 0 15px;
    border-top: 1px solid transparent;
}

.thank-you-content h4 { color: #fff; margin-bottom: 8px; }
.thank-you-content ul { list-style-type: none; padding-left: 0; }
.thank-you-content li { margin-bottom: 5px; }

/* --- 5. The "Open" State --- */
.floating-info-panel.is-open .thank-you-content {
    max-height: 70vh; /* Set a max height based on 70% of the screen's height */
    overflow-y: auto; /* Add a vertical scrollbar ONLY when the content is too long */
    padding: 15px;
    border-top: 1px solid rgba(255, 124, 0, 0.5);
}

/* --- 6. The Animated Arrow on the Link --- */
.thank-you-link::after {
    content: '▼';
    font-size: 10px;
    margin-left: 8px;
    display: inline-block;
    transition: transform 0.3s ease-in-out;
}

.floating-info-panel.is-open .thank-you-link::after {
    transform: rotate(180deg); /* Flips arrow up */
}

/* --- 7. Mobile Responsiveness --- */
@media (max-width: 768px) {
    .floating-info-panel {
        width: 90%;
    }
}
/*|||||||||||||||||||||||||||||||||||||||||||||||||||||*/

 /* Title section text ish        ||||||||||||||||||||| ||||||||||||||||||||| ||||||||||||||||||||| |||||||||||||||||||||*/
      /* activekeys title color |||||||||||||||||||||||||*/    
        h1 {
            color: #ffc600;
            margin-bottom: 15px;
            font-size: 22px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 0 #000, 0 0 2px rgba(255, 198, 0, 0.7);
            font-weight: 700;
        }
    /* perm drops title color |||||||||||||||||||||||||*/
        h2 {
            color: #FF00F7;
            margin: 25px 0 12px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid #ff7c00;
            font-size: 22px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 0 #000;
        }
            /* expired |||||||||||||||||||||||||*/
        h3 {
            color: #F91515;
            margin: 25px 0 12px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid #ff7c00;
            font-size: 22px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 0 #000;
        }
        
        /* Social links styling ||||||||||||||| ||||||||||||||||||||| |||||||||||||||||||||||||||||||*/
/* =================================================== */
/*           HIGH-TECH CONTACT ME SECTION              */
/* =================================================== */

/* =================================================== */
/*    INTERACTIVE HIGH-TECH CONTACT ME SECTION (v2)    */
/* =================================================== */

/* --- The Main Wrapper --- */
.contact-me-section {
    border: 2px solid #00ffff;
    padding: 20px 15px;
    margin: 30px 0;
    background: rgba(17, 26, 34, 0.6);
    box-shadow: 0 0 15px rgba(0, 255, 255, 0.2);
    text-align: center;
    clip-path: polygon(0 0, 100% 0, 100% 95%, 95% 100%, 0 100%);
    border-radius: 0;
    
    /* NEW: Add a transition to the container itself for smooth size changes */
    transition: padding-bottom 0.4s ease-in-out;
}

/* --- The "Contact Me" Title --- */
.contact-me-title {
    color: #00ffff;
    font-family: 'Chakra Petch', sans-serif;
    text-transform: uppercase;
    font-weight: 700;
    font-size: 18px;
    letter-spacing: 2px;
    text-shadow: 0 0 2px rgba(0, 255, 255, 0.8);
    margin: 0;
    
    /* NEW: Make the title look clickable */
    cursor: pointer;
}

/* =================================================== */
/*           THE SLIDE-DOWN EFFECT LOGIC               */
/* =================================================== */

/* --- 1. The Button Container (Default HIDDEN State) --- */
.social-links {
    display: flex;
    justify-content: center;
    gap: 12px;
    flex-wrap: wrap;
    
    /* --- CHANGES FOR HIDING --- */
    /* Set max-height to 0 to collapse the container */
    max-height: 0;
    /* Hide the content that overflows the 0-height container */
    overflow: hidden;
    /* Remove any margin when hidden */
    margin: 0;
    /* Add a smooth transition for the slide effect */
    transition: max-height 0.4s ease-in-out, margin-top 0.4s ease-in-out;
}

/* --- 2. The Button Container (Expanded :hover State) --- */
.contact-me-section:hover .social-links {
    /* Set a max-height large enough to fit the content */
    max-height: 200px; /* Adjust if your buttons wrap to more lines */
    /* Add back the margin to create space between title and buttons */
    margin-top: 20px;
}

/* --- The Individual Buttons (No changes needed here) --- */
.social-links a {
    color: #00ffff;
    text-decoration: none;
    font-size: 16px;
    font-weight: 700;
    text-transform: uppercase;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 15px;
    clip-path: polygon(0 0, 100% 0, 100% 75%, 90% 100%, 0 100%);
    border-radius: 0;
    background: #111a22;
    border: 2px solid #00ffff;
    text-shadow: 0 0 2px rgba(0, 255, 255, 0.7);
    box-shadow: inset 0 0 5px rgba(0, 255, 255, 0.3);
    transition: all 0.2s ease;
}

.social-links a:hover,
.social-links a:focus-visible {
    color: #111a22;
    background: #00ffff;
    transform: translateY(-2px);
    box-shadow: 0 2px 15px rgba(0, 255, 255, 0.5);
    outline: none;
}

/*||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||*/

 /* active and perm code boxs |||||||||||||||||||||||||*/       
        .code-box {
            background: linear-gradient(135deg, #3A2A1A, #5C3C10); /* Gold-themed */
            color: white;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            text-align: left;
            transition: transform 0.2s;
            border: 2px solid #D4A017; 
            box-shadow: 0 0 8px rgba(212, 160, 23, 0.3); 
            position: relative;
        }

        .code-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 12px rgba(255, 179, 71, 0.5); 
        }
  /* old perm box? keep as it does the style |||||||||||||||||||||||||*/       
        .permanent-code-box {
            background: linear-gradient(135deg, #1b3b6a 0%, #0f2552 100%);
            color: white;
            padding: 12px 15px;
            margin: 10px 0;
            border-radius: 4px;
            text-align: left;
            transition: transform 0.2s;
            border: 1px solid #4a90e2;
            box-shadow: 0 0 4px rgba(74, 144, 226, 0.4);
            position: relative;
        }
        
        .permanent-code-box:hover {
            transform: translateY(-1px);
            box-shadow: 0 0 6px rgba(74, 144, 226, 0.6);
        }
/* New style for Black Market Vendor */
.black-market-code-box {
    background: linear-gradient(135deg, #4d0000, #2d0000); /* Dark red/black */
    border: 2px solid #ff4444; /* Red border */
    box-shadow: 0 0 8px rgba(255, 68, 68, 0.3);
    color: #ffcccc; /* Default text color */
    padding: 15px; /* This padding was already correct */
    margin: 12px 0; /* Changed from 15px to 12px to match .code-box */
    border-radius: 4px;
    text-align: left;
    transition: transform 0.2s;
    position: relative;
}
        .black-market-code-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 12px rgba(255, 68, 68, 0.5);
        }
        .black-market-code-box .code-text { color: #ffaa99; }
        .black-market-code-box .title-container { color: #ff9999; }
        .black-market-code-box .expire-date { color: #ffcccc; }
        .black-market-code-box .countdown {
            color: #ffaaaa;
            border: 1px solid #ffaaaa;
        }
        /* Redeemed style for black market vendor */
        .black-market-code-box.redeemed {
            opacity: 0.7;
            position: relative;
                        border: 2px solid #44ff44;
        }
        .black-market-code-box.redeemed::after {
            content: "REDEEMED";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            font-size: 24px;
            font-weight: bold;
            color: #7cff7c; /* Green checkmark color */
            text-shadow: 2px 2px 0 #000, 0 0 10px rgba(124, 255, 124, 0.7);
            z-index: 10;
            pointer-events: none;
        }
        .black-market-code-box.redeemed .code-text {
            color: #7cff7c !important;
        }

/* style change for the  code box section |||||||||||||||||||||||||*/        
        .code-box {
            background: linear-gradient(135deg, #3A2A1A 0%, #5C3C10 100%);
            color: #D4A017;
            padding: 15px;
            margin: 12px 0;
            border-radius: 4px;
            text-align: left;
            border: 2px solid #D4A017;
            box-shadow: 0 0 5px rgba(255, 68, 68, 0.3);
            position: relative;
        }
        
        .code-box .code-text {
            color: #FFBC01;
            text-shadow: 1px 1px 0 #400000;
        }
        
        .code-box .title-container {
            color: #FFBC01;
        }
        
        .code-box .expire-date {
            color: #FFBC01;
        }
        
        .code-box.redeemed {
        /*    background: linear-gradient(135deg, #2c5a2c 100%, #1c3a1c 100%); */
            border: 2px solid #44ff44;
            box-shadow: 0 0 5px rgba(68, 255, 68, 0.3);
        }
        
        .code-boxredeemed .code-text {
            color: #7cff7c !important;
            text-shadow: 1px 1px 0 #004000;
        }
        
       /*    .expired-code-box.redeemed .title-container {
            color: #9eff9e;
        }  */
        
         /*  .expired-code-box.redeemed .expire-date {
            color: #aaffaa; 
        } */

/* style change for the expired code box section |||||||||||||||||||||| ||||||||||||||||||||| ||||||||||||||||||||||||*/        
        .expired-code-box {
            background: linear-gradient(135deg, #5a2c2c 0%, #3a1c1c 100%);
            color: #ff9999;
            padding: 15px;
            margin: 12px 0;
            border-radius: 4px;
            text-align: left;
            border: 2px solid #ff4444;
            box-shadow: 0 0 5px rgba(255, 68, 68, 0.3);
            position: relative;
        }
        
        .expired-code-box .code-text {
            color: #ff6666;
            text-shadow: 1px 1px 0 #400000;
        }
        
        .expired-code-box .title-container {
            color: #ff9999;
        }
        
        .expired-code-box .expire-date {
            color: #ffaaaa;
        }
        
        .expired-code-box.redeemed {
        /*    background: linear-gradient(135deg, #2c5a2c 100%, #1c3a1c 100%); */
            border: 2px solid #44ff44;
            box-shadow: 0 0 5px rgba(68, 255, 68, 0.3);
        }
        
        .expired-code-box.redeemed .code-text {
            color: #7cff7c !important;
            text-shadow: 1px 1px 0 #004000;
        }
        
       /*    .expired-code-box.redeemed .title-container {
            color: #9eff9e;
        }  */
        
         /*  .expired-code-box.redeemed .expire-date {
            color: #aaffaa; 
        } */
/* active code text color gold  |||||||||||||||||||||||||*/            
        .code-text {
            font-family: 'Courier New', monospace;
            font-size: 18px;
            font-weight: bold;
            margin: 12px 0;
            word-break: break-all;
            letter-spacing: 1px;
            color: #ffc600;
            text-shadow: 1px 1px 0 #000;
        }
 /* active code text color gold ffc600 : not sure if works  |||||||||||||||||||||||||*/          
        .permanent-code-text {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            font-weight: bold;
            margin: 0 0 4px 0;
            word-break: break-all;
            letter-spacing: 0.5px;
            color: #ffc600;
            text-shadow: 1px 1px 0 #000, 0 0 5px rgba(255, 198, 0, 0.7);
            line-height: 1.2;
        }
        
        .code-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid rgba(255, 198, 0, 0.3);
        }
        
        .permanent-code-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 8px;
            padding-top: 5px;
            border-top: 1px solid rgba(107, 168, 255, 0.3);
        }

 /* active copy button |||||||||||||||||||||*/       
        .small-copy-btn {
            background: linear-gradient(to bottom, #ff7c00, #e56a00);
            border: 1px solid #ffc600;
            color: #fff;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            order: 2;
        }
        
        .small-copy-btn:hover {
            background: linear-gradient(to bottom, #ff8c00, #ff6a00);
            transform: scale(1.05);
            box-shadow: 0 0 6px #ffc600;
        }
   /* permanent copy button |||||||||||||||||||||*/         
        .permanent-copy-btn {
            background: linear-gradient(to bottom, #B634D7, #AA2EC9);
            border: 1px solid #DE57FF;
            color: #FFFFFF;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            order: 2;
        }
        
        .permanent-copy-btn:hover {
            background: linear-gradient(to bottom, #AA2EC9, #B634D7);
            transform: scale(1.05);
            box-shadow: 0 0 4px #DE57FF;
        }
       /* expired copy button |||||||||||||||||||||*/         
        .expired-copy-btn {
            background: linear-gradient(to bottom, #EE2222, #DF2525);
            border: 1px solid #FF5757;
            color: #FFFFFF;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            order: 2;
        }
        
        .expired-copy-btn:hover {
            background: linear-gradient(to bottom, #DF2525, #EE2222);
            transform: scale(1.05);
            box-shadow: 0 0 4px #FF5757;
        }    
        .countdown {
            font-size: 14px;
            font-weight: bold;
            color: #ff7c00;
            margin: 8px 0;
            padding: 4px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            text-shadow: 1px 1px 0 #000;
            border: 1px solid #ff7c00;
        }
        
        .expire-date {
            font-size: 13px;
            color: #ff9e40;
            margin: 4px 0;
            font-style: italic;
            text-shadow: 1px 1px 0 #000;
        }
 /* active code text color gold 6ba8ff : not sure if works  |||||||||||||||||||||||||*/         
        .permanent-text {
            font-size: 10px;
            color: #E600FF;
            margin: 0;
            font-weight: bold;
            text-shadow: 1px 1px 0 #000, 0 0 3px rgba(107, 168, 255, 0.5);
            display: inline-block;
        }
        
        .copied-message {
            color: #7cff7c;
            font-weight: bold;
            display: none;
            margin-left: 5px;
            font-size: 11px;
            text-shadow: 1px 1px 0 #000;
            order: 3;
        }
        
        .permanent-copied-message {
            color: #7cff7c;
            font-weight: bold;
            display: none;
            margin-left: 5px;
            font-size: 11px;
            text-shadow: 1px 1px 0 #000;
            order: 3;
        }
        /* redeem button orange go to shift site ///////////////////*/        
        .rewards-link {
            display: block;
            width: fit-content;            
            background: linear-gradient(to bottom, #ff7c00, #e56a00);
            color: white;
            padding: 2px 24px;
            text-decoration: none;
            border-radius: 4px;
            margin: 10px auto 15px auto;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 2px solid #ffc600;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
        }
        
        .rewards-link:hover {
            background: linear-gradient(to bottom, #ff8c00, #ff6a00);
            transform: scale(1.05);
            box-shadow: 0 0 10px #ffc600;
        }
        
        /* BUTTONS SIDE BY SIDE */
        .info-button {
            background: linear-gradient(to bottom, #4a4a4a, #2a2a2a);
            color: white;
            padding: 12px 20px;
            border-radius: 4px;
            margin: 0;
            font-weight: bold;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 2px solid #888;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
            cursor: pointer;
            display: inline-block;
            width: auto;
            flex: 1;
            min-width: 0;
        }

        .info-button:hover {
            background: linear-gradient(to bottom, #5a5a5a, #3a3a3a);
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }

/* Hde Buttons color  ||||||||||||||||||||| ||||||||||||||||||||| |||||||||||||||||||||||||*/
#hideem-toggle-btn {
            background: linear-gradient(to bottom, #B9B9B9, #363337);
            border: 2px solid #888;
        }

#hideem-toggle-btn:hover {
            background: linear-gradient(to bottom, #B9B9B9, #363337);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.3);
        }

/* (INFO & FAQ) color  |||||||||||||||||||||||||*/
#infofaq-toggle-btn {
            background: linear-gradient(to bottom, #22FEFE, #363337);
            border: 2px solid #adb5bd;
        }

#infofaq-toggle-btn:hover {
            background: linear-gradient(to bottom, #22FEFE, #363337);
            box-shadow: 0 0 8px #adb5bd;
        }

/* CHANGE LOG color an button  |||||||||||||||||||||||||*/
#changlog-toggle-btn {
            margin-top: 1px; /* Adjust this value as needed to lower it more or less */
            background: linear-gradient(to bottom, #537CB9, #363337);
              border: 2px solid #adb5bd;
        }

#changlog-toggle-btn:hover {
            background: linear-gradient(to bottom, #537CB9, #363337);
            box-shadow: 0 0 8px #00ccff;
        }

/* How to redeem color an button  |||||||||||||||||||||||||*/
#redeem-toggle-btn {
    margin-top: 5px;
    background: linear-gradient(to bottom, #00aa00, #0055aa);
    border: 2px solid #00ccff;
}

#redeem-toggle-btn:hover {
    background: linear-gradient(to bottom, #00cc00, #0077cc);
    box-shadow: 0 0 8px #00ccff;
}

        /* Responsive design for mobile ||||||||||||||||||||| ||||||||||||||||||||| |||||||||||||||||||||||||*/
        @media (max-width: 768px) {
            .button-row {
                flex-direction: column;
                align-items: center;
            }
            
            .info-button {
            display: block; /* Default to block for stacking */
            width: fit-content; /* Make width fit content */
            margin: 10px auto; /* Default for stacking: center horizontally, provide vertical space */
            flex-shrink: 0; /* Prevent shrinking when inside flex container */
            }
                    /* Specific adjustments for buttons inside .top-header-buttons */
        .top-header-buttons .info-button {
            margin: 0; /* Remove auto margins when inside flex, let gap handle spacing */
            margin-bottom: 10px; /* Add vertical margin for wrapping on mobile */
        }
        }
        
        /*|||||||||||||||||||||||||*/

        .collapse-btn {
            background: linear-gradient(to bottom, #555, #333);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 8px 0;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 1px solid #666;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
        }
        
        .collapse-btn:hover {
            background: linear-gradient(to bottom, #666, #444);
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }
        /* expired button color and style |||||||||||||||||||||||||*/
        .collapse-btn-exp {
            background: linear-gradient(to bottom, #46171D, #E82740);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 8px 0;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 1px solid #FF0022;
            text-shadow: 1px 1px 0 #FF0022;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
        }
        
        .collapse-btn-exp:hover {
            background: linear-gradient(to bottom, #E82740, #46171D);
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }
 /* drops an limited time codes an more button ish  |||||||||||||| ||||||||||||||||||||||||||||||||*/          
        .collapse-btn-Perm {
                        display: block;
            width: fit-content;
            background: linear-gradient(to bottom, #f70, #A0F);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
margin: 10px auto;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 1px solid #666;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
        }
        
        .collapse-btn-Perm:hover {
            background: linear-gradient(to bottom, #F90, #A4F);
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.2);
        }       
 
 /* New Black Market button style  ||||||||||||||||||| ||||||||||||||||||||| |||||||||||||||||||||||||||*/       
.collapse-btn-BlackMarket { 
                display: block;
                            width: fit-content;
            background: linear-gradient(to bottom, #CC0000, #800000); /* Red */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px auto;
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 1px solid #FF4444; /* Brighter red border */
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
        }
        
        .collapse-btn-BlackMarket:hover {
            background: linear-gradient(to bottom, #FF0000, #600000); /* Brighter red on hover */
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 68, 68, 0.4); /* Red glow */
        }

 /* Style for the container inside the Black Market dropdown */
#black-market-codes-container {
    /* All the red box styling has been removed from here */
    margin-top: 8px;
    text-align: left;
}
        /* Ensure the H2 inside the black market section has appropriate styling */
        #black-market-section h2 {
            color: #ff9999; /* Lighter red for heading */
            border-bottom-color: #ff6666;
        }    
        
/* Only when permanent section is visible (has 'show' class) change title text color an more */
#permanent-section.show .permanent-code-box {
    background: linear-gradient(180deg, #451565, #6D1489);
    border: 1px solid #920F74;
    box-shadow: 0 0 6px rgba(54, 54, 0, 0.6);
}

#permanent-section.show .permanent-code-box:hover {
    background: linear-gradient(180deg, #6D1489, #451565);
    border: 1px solid #920F74;
    box-shadow: 0 0 8px rgba(245, 76, 217, 0.8);
}
/* Text color for where tittle is like discord or twitch drop */
#permanent-section.show .permanent-code-text {
    color: #d50eeb;
    text-shadow: 1px 1px 0 #000, 0 0 10px rgba(54, 54, 54, 1);
    font-weight: bold;
}
/* info or body text color for perm box */
#permanent-section.show .permanent-title-container {
    color: #FF99FF;
    text-shadow: 1px 1px 0 #000, 0 0 2px #000;
    font-weight: bold;
}
        
        .expired-section, .permanent-section, .info-section {
            display: none;
            margin-top: 8px;
        }
        
        .expired-section.show, .permanent-section.show, .info-section.show {
            display: block;
        }
        .permanent-code-box .expire-date { color: #E830B7; }
        .permanent-code-box .countdown { color: #E144FF !important; border: 1px solid #F5BFFF;         }
/* ========================================================== */
/*     STYLES FOR EXPIRATION & COUNTDOWN (PURPLE SECTIONS)    */
/* ========================================================== */

/* --- Styling for the "Expires:" text --- */
#permanent-codes-section .expire-date,
#twitch-drops-section .expire-date {
    color: #DD8BFF; /* Golden/Orange text color */
    font-size: 11px;
    text-shadow: 1px 1px 0 #000;
    margin-bottom: 6px; /* Adds a little space below it */
    text-align: left;
}


/* --- Styling for the "Time left:" countdown box --- */
#permanent-codes-section .countdown,
#twitch-drops-section .countdown {
    border: 1px solid #ff9e40; /* Orange border */
    border-radius: 4px; /* Slightly rounded corners */
    color: #FF76DB; /* Orange text color */
    font-weight: bold;
    text-shadow: 1px 1px 0 #000;
    padding: 6px 10px; /* Space inside the box */
    margin-top: 5px; /* Space above the box */
    margin-bottom: 10px; /* Space below the box */
    text-align: left;
}


    /* =================================================== */
/*           STYLES FOR THE GOLD SECTION               */
/*         ( 👍 ACTIVE BL4 SHIFT CODES )                */
/* =================================================== */

.title-container {
    font-size: 14px;
    color: #ff9e40;
    margin-bottom: 8px;
    min-height: 18px;
    text-shadow: 1px 1px 0 #000;
}

/* This targets links like "Via Twit" */
.title-container a {
    color: #F6E261; /* Teal color */
    text-decoration: underline;
    text-shadow: 1px 1px 0 #000;
    font-weight: bold;
}

.title-container a:hover {
    color: #DBBE00; /* Lighter teal for hover */
}


/* =================================================== */
/*          STYLES FOR THE PURPLE SECTION              */
/* (Twitch Drops & Permanent Codes like the cosmetics) */
/* =================================================== */

/* --- STYLES FOR THE PURPLE SECTION (TWITCH DROPS, ETC.) --- */

.permanent-title-container {
    /* This styles the container itself, you can leave it empty if you want */
    font-size: 11px;
    color: #F2D7EE; /* This is the gold/orange text color */
    /* ... other container styles ... */
}

/* This targets ALL links inside the purple container */
.permanent-title-container a {
    color: #FF5BDA; /* Light Sky Blue color for links */
    text-decoration: underline;
    font-weight: bold;
    text-shadow: 1px 1px 0 #000;
}

.permanent-title-container a:hover {
    color: #FFB7FE; /* Lighter blue for hover */
}

/* --- Style for links ONLY inside an EXPIRED code box --- */
.expired-code-box .title-container a {
    color: #CD2F2F; /* Pale Yellow - looks good on the red background */
    text-decoration: underline;
    font-weight: bold;
    text-shadow: 1px 1px 0 #000;
}

/* --- Hover effect for the expired code links --- */
.expired-code-box .title-container a:hover {
    filter: brightness(1.2); /* A subtle pop on hover */
}

/*||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| ||||||||||||||||||||| |||||||||||||||||||||||||*/        
        .code-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        
        .permanent-code-header {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 2px;
        }
        
        .key-icon {
            font-size: 18px;
            color: #ffc600;
            text-shadow: 1px 1px 0 #000;
        }
        
        .permanent-key-icon {
            font-size: 12px;
            color: #6ba8ff;
            text-shadow: 1px 1px 0 #000, 0 0 3px rgba(107, 168, 255, 0.5);
        }
        
        .custom-icon {
            width: 18px;
            height: 18px;
            object-fit: contain;
            vertical-align: middle;
        }
        
        .permanent-custom-icon {
            width: 25px;
            height: 25px;
            object-fit: contain;
            vertical-align: middle;
        }

/* Specific styling for 'active codes' */
.active-codes-icon {
    width: 20px; /* Example: slightly larger */
    height: 20px;
    object-fit: contain;
    vertical-align: middle;
    /* Add any other specific styling here */
    font-size: 16px; /* For text-based active codes */
    line-height: 18px;
    display: inline-block; /* Ensure it respects width/height */
}

/* Specific styling for 'blackmarket' codes */
.blackmarket-icon {
    width: 32px; /* Example: adjust as needed for blackmarket */
    height: 32px;
    object-fit: contain;
    vertical-align: middle;
    /* Add any other specific styling here */
    font-size: 20px; /* For text-based blackmarket codes */
    line-height: 25px;
    display: inline-block; /* Ensure it respects width/height */
}

/* General alignment for headers */
.code-header {
    display: flex;
    align-items: center;
    gap: 8px; /* Adjust spacing */
}
        
        .vault-symbol {
            font-size: 24px;
            margin-right: 10px;
            color: #ffc600;
            text-shadow: 1px 1px 0 #000, 0 0 5px rgba(255, 198, 0, 0.5);
        }
            
        .no-codes {
            color: #ff9e40;
            padding: 20px;
            text-shadow: 1px 1px 0 #000;
        }
        
        .clearfix::after {
            content: "";
            clear: both;
            display: table;
        }

    /*|||||||| active yellow check box color and shit  ||||| ||||||||||||||||||||| |||||||||||||||||||||||||||||*/      
 /* ========================================================== */
/*           PARENT FOOTER - THIS IS THE MAIN FIX             */
/* ========================================================== */
/* This rule targets the container holding the checkbox and the button */
.code-footer, .permanent-code-footer {
    display: flex;                  /* Turns it into a flex container */
    justify-content: space-between; /* MAGIC! Puts first item on left, last on right */
    align-items: center;            /* Vertically aligns everything neatly */
}

/* ========================================================== */
/*                 BM Codes CHECKBOX STYLES                     */
/* ========================================================== */
/* This no longer needs the margin-right: auto */
.bmredeem-checkbox {
    display: flex;
    align-items: center; 
    /* The 'margin-right: auto' has been REMOVED from here */
}

/* --- The rest of your styles are perfect and remain unchanged --- */

.bmredeem-checkbox input[type="checkbox"] {
    appearance: none;
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    border: 2px solid #FF0009;
    border-radius: 3px;
    background: rgba(0, 0, 0, 0.3);
    position: relative;
    cursor: pointer;
    margin-right: 8px;
}

.bmredeem-checkbox input[type="checkbox"]:checked::before {
    content: "✓";
    position: absolute;
    color: #FF4D53;
    font-size: 14px;
    font-weight: bold;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-shadow: 0 0 3px #000;
}

.bmredeem-checkbox label {
    color: #ffc600;
    font-size: 14px;
    cursor: pointer;
    text-shadow: 1px 1px 0 #000;
}


/* ========================================================== */
/*                  Active Codes CHECKBOX STYLES                     */
/* ========================================================== */
/* This no longer needs the margin-right: auto */
.actredeem-checkbox {
    display: flex;
    align-items: center; 
    /* The 'margin-right: auto' has been REMOVED from here */
}

/* --- The rest of your styles are perfect and remain unchanged --- */

.actredeem-checkbox input[type="checkbox"] {
    appearance: none;
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    border: 2px solid #FFD31E;
    border-radius: 3px;
    background: rgba(0, 0, 0, 0.3);
    position: relative;
    cursor: pointer;
    margin-right: 8px;
}

.actredeem-checkbox input[type="checkbox"]:checked::before {
    content: "✓";
    position: absolute;
    color: #FFDC4D;
    font-size: 14px;
    font-weight: bold;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-shadow: 0 0 3px #000;
}

.actredeem-checkbox label {
    color: #ffc600;
    font-size: 14px;
    cursor: pointer;
    text-shadow: 1px 1px 0 #000;
}

/* ========================================================== */
/*                 PERM Codes CHECKBOX STYLES                     */
/* ========================================================== */
/* This no longer needs the margin-right: auto */
.permredeem-checkbox {
    display: flex;
    align-items: center; 
    /* The 'margin-right: auto' has been REMOVED from here */
}

/* --- The rest of your styles are perfect and remain unchanged --- */

.permredeem-checkbox input[type="checkbox"] {
    appearance: none;
    -webkit-appearance: none;
    width: 18px;
    height: 18px;
    border: 2px solid #FF1FE2;
    border-radius: 3px;
    background: rgba(0, 0, 0, 0.3);
    position: relative;
    cursor: pointer;
    margin-right: 8px;
}

.permredeem-checkbox input[type="checkbox"]:checked::before {
    content: "✓";
    position: absolute;
    color: #FF78F1;
    font-size: 14px;
    font-weight: bold;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-shadow: 0 0 3px #000;
}

.permredeem-checkbox label {
    color: #ffc600;
    font-size: 14px;
    cursor: pointer;
    text-shadow: 1px 1px 0 #000;
}

  /*|||||||| check box color and shit  |||||||||||||*/      
        .redeem-checkbox {
            display: flex;
            align-items: center;
            margin: 0;
            order: 1;
        }
        
        .redeem-checkbox input[type="checkbox"] {
            appearance: none;
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border: 2px solid #878787;
            border-radius: 3px;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
            cursor: pointer;
            margin-right: 8px;
        }
        
        .redeem-checkbox input[type="checkbox"]:checked::before {
            content: "✓";
            position: absolute;
            color: #E5E5E5;
            font-size: 14px;
            font-weight: bold;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-shadow: 0 0 3px #000;
        }
        
        .redeem-checkbox label {
            color: #ffc600;
            font-size: 14px;
            cursor: pointer;
            text-shadow: 1px 1px 0 #000;
        }
        
        .redeemed {
            opacity: 0.7;
            position: relative;
        }
        
        .redeemed::after {
            content: "REDEEMED";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            font-size: 24px;
            font-weight: bold;
            color: #7cff7c;
            text-shadow: 2px 2px 0 #000, 0 0 10px rgba(124, 255, 124, 0.7);
            z-index: 10;
            pointer-events: none;

        }
        
        .redeemed .code-text {
            color: #7cff7c !important;
        }
        
        .permanent-redeemed {
            opacity: 0.7;
            position: relative;
        }
        
        .permanent-redeemed::after {
            content: "REDEEMED";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            font-size: 24px;
            font-weight: bold;
            color: #7cff7c;
            text-shadow: 2px 2px 0 #000, 0 0 10px rgba(124, 255, 124, 0.7);
            z-index: 10;
            pointer-events: none;
        }
        
        .permanent-redeemed .permanent-code-text {
            color: #7cff7c !important;
        }

/* Brute-force style for testing */
.permanent-code-box.permanent-redeemed {
    border: 2px solid #44ff44 !important; /* A bright, ugly, unmissable green border */
}
/* ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||*/
        .expired-text {
            color: #ff4444;
            font-weight: bold;
            margin-top: 8px;
            font-size: 13px;
            text-shadow: 1px 1px 0 #400000;
        }
        
        .info-content {
            background: linear-gradient(to bottom, #555, #333);
            color: white;
            padding: 15px;
            margin: 8px 0;
            border-radius: 4px;
            text-align: left;
            border: 1px solid #666;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .info-content p {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .info-content ul, .info-content ol {
            margin-left: 20px;
            margin-bottom: 10px;
        }
        
        .info-content li {
            margin-bottom: 5px;
        }
        
        .info-content a {
            color: #ffc600;
            text-decoration: underline;
            text-shadow: 1px 1px 0 #000;
        }
        
        .info-content a:hover {
            color: #ff7c00;
        }
        
        @media (max-width: 600px) {
            .social-links {
                gap: 10px;
            }
            
            .social-links a {
                font-size: 14px;
                padding: 6px 10px;
            }
        }
        .title-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px 25px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            margin-bottom: 15px;
            border: 2px solid #ffc600;
        }

        .title-text {
            color: #ffc600;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 0 #000, 0 0 10px rgba(255, 198, 0, 0.7);
        }

        .icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #ffc600;
        }
/* Normal blue preview button ||||||||||||| ||||||||||||||||||||| ||||||||||||||||||||| ||||||||||||||||||||||||*/
        .preview-btn {
            background: linear-gradient(to bottom, #4a90e2, #2a70c2);
            border: 1px solid #6ba8ff;
            color: #fff;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .preview-btn:hover {
            background: linear-gradient(to bottom, #2a70c2, #4a90e2);
            transform: scale(1.05);
            box-shadow: 0 0 4px #6ba8ff;
        }

        /* perm active preview button ||||||||||||||||*/
        .prempreview-btn {
            background: linear-gradient(to bottom, #B634D7, #AA2EC9);
            border: 1px solid #DE57FF;
            color: #FFFFFF;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .prempreview-btn:hover {
            background: linear-gradient(to bottom, #AA2EC9, #B634D7);
            transform: scale(1.05);
            box-shadow: 0 0 4px #DE57FF;
        }

        /* active preview button ||||||||||||||||*/
        .activepreview-btn {
            background: linear-gradient(to bottom, #ff7c00, #e56a00);
            border: 1px solid #FFDE00;
            color: #FFFFFF;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .activepreview-btn:hover {
            background: linear-gradient(to bottom, #e56a00, #ff7c00);
            transform: scale(1.05);
            box-shadow: 0 0 4px #FFDE00;
        }

        /* expire preview button ||||||||||||||||*/
        .exppreview-btn {
            background: linear-gradient(to bottom, #EE2222, #DF2525);
            border: 1px solid #FF5757;
            color: #FFFFFF;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin: 0;
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .exppreview-btn:hover {
            background: linear-gradient(to bottom, #DF2525, #EE2222);
            transform: scale(1.05);
            box-shadow: 0 0 4px #FF5757;
        }
        /*||||||||||||||| ||||||||||||| ||||||||||||||||||||| ||||||||||||||||||||||||*/
        .image-preview-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
                overflow: auto; /* Allow scrolling/zooming within modal */
    -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }

        .image-preview-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
                margin: 20px; /* Space for close button */
        }

        .image-preview-content img {
            max-width: 100%;
            max-height: 90vh;
            border: 3px solid #ffc600;
            border-radius: 5px;
        }

        .close-preview {
    position: absolute;
    top: -15px;
    right: -15px;
    background: #ff4444;
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    font-size: 20px;
    cursor: pointer;
    font-weight: bold;
    z-index: 1001;
    box-shadow: 0 2px 8px rgba(0,0,0,0.7);
}

/* Allow zooming within the image/content */
.image-preview-content img,
.image-preview-content video,
#preview-container {
    max-width: 100%;
    max-height: 100%;
    /* These properties allow pinch-to-zoom */
    touch-action: manipulation;
    -webkit-user-select: none;
    user-select: none;
}

        /* Info content sections ||||||||||| ||||||||||||||||||||| |||||||||||||||||||||||||||||||*/
        #info-section .info-content {
            background: linear-gradient(to bottom, #555, #333);
            border: 2px solid #888;
            color: white;
        }

        #changelog-section .info-content {
            background: linear-gradient(to bottom, #6c757d, #495057);
            border: 2px solid #adb5bd;
            color: white;
        }

        #changelog-section .info-content a {
            color: #e9ecef;
            text-shadow: 0 0 5px #e9ecef;
        }

        #changelog-section .info-content a:hover {
            color: #ffffff;
        }

        #redeem-section .info-content {
            background: linear-gradient(to bottom, #00aa00, #0055aa);
            border: 2px solid #00ccff;
            color: white;
        }

        #redeem-section .info-content a {
            color: #00ffff;
            text-shadow: 0 0 5px #00ffff;
        }

        #redeem-section .info-content a:hover {
            color: #ffffff;
        }

    /* Style for the new "View Roadmap" button |||||||||||||| ||||||||||||||||||||| ||||||||||||||||||||||||||||*/
        .roadmap-button {
            background: linear-gradient(to bottom, #333, #111); /* Dark grey to black gradient */
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 1px auto 5px auto; /* Top margin, auto left/right, bottom margin */
            transition: all 0.3s;
            font-size: 14px;
            text-transform: uppercase;
            border: 1px solid #555; /* Dark grey border */
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            font-family: 'Chakra Petch', sans-serif;
            display: block;
            width: fit-content;
            margin: 10px auto; /* Center horizontally, provide vertical spacing */
        }
        
        .roadmap-button:hover {
            background: linear-gradient(to bottom, #444, #222); /* Slightly lighter on hover */
            transform: scale(1.05);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.1); /* Subtle white glow */
        }

        /* =================================================== */
/*           PASTE THE NEW BUTTON STYLE HERE           */
/* =================================================== */
/*  This is where you can easily customize the colors  */
.events-button {
    background: linear-gradient(to bottom, #2E8B57, #1E5638); /* SeaGreen gradient */
    color: white;
    padding: 10px 20px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.3s;
    font-size: 14px;
    text-transform: uppercase;
    border: 1px solid #3CB371; /* MediumSeaGreen border */
    text-shadow: 1px 1px 0 #000;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    font-family: 'Chakra Petch', sans-serif;
    display: block;
    width: fit-content;
    margin: 10px auto; 
}

.events-button:hover {
    background: linear-gradient(to bottom, #3CB371, #2E8B57); /* Lighter green on hover */
    transform: scale(1.05);
    box-shadow: 0 0 8px rgba(60, 179, 113, 0.6); /* Green glow */
}
/* =================================================== */

/* Style for the new extra button inside the Black Market Vendor box ||||||| ||||||||||||||||||||| |||||||||||||||||||||||||||||||||||*/
        .black-market-extra-btn {
            background: linear-gradient(to bottom, #777, #555); /* Gray gradient */
            border: 1px solid #999;
            color: #fff;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-weight: bold;
            margin-left: 10px; /* Adds space from the "View Location" button */
            transition: all 0.3s;
            font-size: 12px;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .black-market-extra-btn:hover {
            background: linear-gradient(to bottom, #888, #666);
            transform: scale(1.05);
            box-shadow: 0 0 4px #aaa;
        }


                /* Container for the two small Black Market buttons */
        .black-market-buttons-group {
            display: flex;
            flex-wrap: wrap; /* Allow buttons to wrap if screen is too small */
            gap: 8px; /* Space between the two buttons */
            align-items: center;
        }

        /* Base style for small Black Market buttons  |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||*/
        .bm-small-btn {
            padding: 4px 8px; /* Reduced padding */
            font-size: 10px; /* Reduced font size */
            font-weight: bold;
            border-radius: 3px;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            font-family: 'Chakra Petch', sans-serif;
            text-shadow: 1px 1px 0 #000;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            flex-shrink: 0; /* Prevent them from shrinking too much */
            line-height: 1.2; /* Adjust line height for smaller text */
        }
        
        .bm-small-btn:hover {
            transform: scale(1.03);
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }

        /* Specific style for the Static Image button  ||||||||||||||||||||| ||||||||||||||||||||| |||||||||||||||||||||*/
        .bm-static-image-btn {
            background: linear-gradient(to bottom, #FF7A7F, #C92B31); /* Gray gradient */
            border: 1px solid #DA0007;
            color: #fff;
        }

        .bm-static-image-btn:hover {
            background: linear-gradient(to bottom, #C92B31, #FF7A7F);
        }

        /* Specific style for the MapGenie button  ||||||||||||||||||||| ||||||||||||||||||||| |||||||||||||||||||||*/
        .bm-mapgenie-btn {
            background: linear-gradient(to bottom, #C92B31, #FF7A7F); /* Blue gradient */
            border: 1px solid #DA0007;
            color: #fff;
        }

        .bm-mapgenie-btn:hover {
            background: linear-gradient(to bottom, #FF7A7F, #C92B31);
        }

        /* Ensure .redeem-checkbox is properly ordered in the footer */
        .code-footer .redeem-checkbox {
            order: unset; /* Clears any explicit order */
            margin-left: auto; /* <--- ADD THIS to push the checkbox to the far right */
            margin-right: 0; /* Ensure no conflicting right margin */
        }

        /* New group for active code's action buttons (COPY and optional PREVIEW) ||||||||||| |||||||||||||||||||||||||||||||*/
        .active-code-buttons-group {
            display: flex;
            gap: 10px; /* Space between preview and copy buttons */
            align-items: center;
            margin-left: auto; /* Pushes this group to the far right within the footer */
        }
        
        /* Ensure default display for the overall code-footer */
        .code-footer {
            display: flex;
            justify-content: space-between; /* Pushes children to opposite ends */
            align-items: center;
            margin-top: 10px;
            padding-top: 8px;
            border-top: 1px solid rgba(255, 198, 0, 0.3);
        }

        /* Make sure the redeem checkbox explicitly stays left  ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||*/
        /* This overrides any previous 'order' or 'margin-left: auto' */
        .code-footer .redeem-checkbox {
            order: unset; /* Remove any explicit order that might be set */
            margin-right: auto; /* Pushes itself to the left, allowing the button group to go right */
            margin-left: 0; /* Ensure no auto left margin interferes */
        }

        /* Ensure .small-copy-btn and .preview-btn revert to natural order/margins within their new group */
        .small-copy-btn, .preview-btn {
            order: unset; /* Remove any explicit order */
            margin: 0; /* Remove any external margins */
        }
        

/*  ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||*/

        /* Utility class to hide elements ||||||||||||| |||||||||||||||||||||||||||||*/
        .hidden {
            display: none !important;
        }

        /* Styling for the settings items (checkbox and label) */
        .setting-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .setting-item input[type="checkbox"] {
            appearance: none;
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border: 2px solid #ffc600;
            border-radius: 3px;
            background: rgba(0, 0, 0, 0.3);
            position: relative;
            cursor: pointer;
            margin-right: 8px;
            flex-shrink: 0; /* Prevent shrinking */
        }

        .setting-item input[type="checkbox"]:checked::before {
            content: "✓";
            position: absolute;
            color: #ffc600;
            font-size: 14px;
            font-weight: bold;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-shadow: 0 0 3px #000;
        }

        .setting-item label {
            color: #ffc600;
            font-size: 14px;
            cursor: pointer;
            text-shadow: 1px 1px 0 #000;
            line-height: 1.2;
        }

        /* New wrapper for the top-most horizontal buttons ||||||| |||||||||||||||||||||||||||||||||||*/
        .top-header-buttons {
            display: flex;
            justify-content: center; /* Center the buttons within the row */
            flex-wrap: wrap; /* Allow buttons to wrap to the next line on small screens */
            gap: 10px; /* Space between the buttons */
            margin-bottom: 20px; /* Space below the top row */
        }

        /* Style for the Black Market credit text |||||||||||||||||||||*/
        .black-market-credit {
            font-size: 11px;
            color: #bbb; /* Lighter text for credit */
            margin-top: 10px; /* Space above the footer/buttons */
            text-align: left;
            padding: 0 5px; /* Little padding to match content */
            font-weight: bold; /* <--- ADD THIS LINE */
        }

        .black-market-credit a {
            color: #428bca; /* Gold color for links */
            text-decoration: underline;
        }

/* Hide any label that follows a checked checkbox within redeem-checkbox  |||||| ||||||||||||||||||||||||||||||||||||*/
.redeem-checkbox input:checked + label,
.bmredeem-checkbox input:checked + label,
.permredeem-checkbox input:checked + label,
.actredeem-checkbox input:checked + label {
    display: none;
}

/* flash text pulse for drops and limited time shit  |||||| ||||||||||||||||||||||||||||||||||*/  
.drops-pulse {
    animation: pulse 1s infinite;
}

@keyframes pulse {
    0% {
        opacity: 1;
    }
    50% {
        opacity: 0.5;
    }
    100% {
        opacity: 1;
    }
}


/* date added text for boxes |||||||| ||||||||||||||||||||||||||||||||||*/
/* Active Codes Date Added */
.code-box .date-added {
    font-size: 0.8em;
    color: #FFC247; /* Yellow/Orange */
    margin: -10px 0 8px 0; /* Positive margins only */
    font-style: italic;
}

/* Permanent/Drops Codes Date Added */
.permanent-code-box .date-added {
    font-size: 0.75em;
    color: #F011FF; /* Green */
    margin: 3px 0 6px 0; /* Positive margins only */
    font-style: normal;
    font-weight: bold;
}

/* Black Market Date Added */
.black-market-code-box .date-added {
    font-size: 0.7em;
    color: #FF6B47; /* Red/Orange */
    margin: 2px 0 5px 0; /* Positive margins only */
    font-style: italic;
    opacity: 0.9;
}

/* Expired Codes Date Added */
.expired-code-box .date-added {
    font-size: 0.7em;
    color: #888888; /* Gray */
    margin: -10px 0 5px 0; /* Positive margins only */
    font-style: italic;
    text-decoration: line-through;
    opacity: 0.8;
}

/* === Mobile Responsiveness for Active Code Footer === ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||*/
/* =================================================================== */
/*           ⭐ UNIFIED & ENHANCED MOBILE STYLES ⭐                  */
/*   (Replaces all other @media blocks for a consistent experience)   */
/* =================================================================== */
@media (max-width: 768px) {

    /* --- 1. Global & Container Adjustments --- */
    body {
        /* Reduce padding on the sides for more content space */
        padding: 10px;
        /* Slightly increase base font size for better readability */
        font-size: 16px; 
    }

    .container {
        /* Reduce padding inside the main container */
        padding: 15px;
    }

    /* --- 2. Typography for Smaller Screens --- */
    h1, h2, h3 {
        /* Slightly smaller headings to save vertical space */
        font-size: 12px;
    }
    
    .title-text {
        font-size: 14px; /* Make the main header text smaller */
    }

    /* --- 3. Main Page Buttons (Info, Collapse, etc.) --- */
    /* Target all primary action buttons for a consistent look */
    .info-button,
    .collapse-btn,
    .collapse-btn-exp,
    .collapse-btn-Perm,
    .collapse-btn-BlackMarket,
    .roadmap-button {
        display: block;  /* Make them block-level to stack */
        width: 100%;     /* Make them full-width for an organized look */
        margin: 10px 0;  /* Consistent vertical spacing, no horizontal auto-margin */
        padding: 14px;   /* Increase padding for a larger, easier tap area */
        font-size: 15px; /* Slightly larger font for readability */
    }
    
    .rewards-link {
        padding: 12px; /* Make the redeem link easier to tap */
    }

    /* --- 4. Code Box Footers (The most important part!) --- */
    /* Target all footer variations */
    .code-footer,
    .permanent-code-footer {
        flex-direction: column; /* Stack all items vertically */
        align-items: stretch;   /* Stretch items to full width */
        gap: 15px;              /* Increase space between stacked items (checkbox and button group) */
    }

    /* --- 5. Button Groups within Footers --- */
    /* Target all button groups for consistent stacking */
    .active-code-buttons-group,
    .black-market-buttons-group {
        display: flex;
        flex-direction: column; /* Stack buttons inside the group vertically */
        width: 100%;            /* Make the group take full width */
        gap: 8px;               /* Space between stacked buttons */
        margin: 0;              /* Reset any margins */
    }

    /* --- 6. Individual Buttons within Footers --- */
    /* Make ALL buttons inside footers full-width and easy to tap */
    .small-copy-btn,
    .permanent-copy-btn,
    .expired-copy-btn,
    .preview-btn,
    .prempreview-btn,
    .activepreview-btn,
    .exppreview-btn,
    .bm-small-btn {
        width: 100%;
        padding: 12px;     /* Generous padding for easy tapping */
        font-size: 14px;   /* Clear, readable text */
        margin: 0;         /* Reset margins */
    }

    /* --- 7. Checkboxes in Footers --- */
    /* Ensure checkboxes align nicely at the top of the stacked footer */
    .redeem-checkbox,
    .permredeem-checkbox,
    .actredeem-checkbox,
    .bmredeem-checkbox {
        margin: 0;  /* Remove any auto margins */
        order: -1;  /* Force the checkbox to always appear first (at the top) */
        padding-bottom: 5px; /* Add a little space below the checkbox */
    }
    
    /* Make the checkbox label larger and easier to read/tap */
    .redeem-checkbox label,
    .permredeem-checkbox label,
    .actredeem-checkbox label,
    .bmredeem-checkbox label {
        font-size: 16px;
    }
}

/* =================================================== */
/*           NEW: CODE DESCRIPTION STYLING             */
/* =================================================== */
.code-description {
    font-size: 14px;
    color: #ffcc88; /* A lighter, less prominent gold */
    line-height: 1.4;
    margin-bottom: 12px;
    padding-left: 5px;
    border-left: 2px solid rgba(255, 198, 0, 0.4); /* Subtle left border */
}

/* Specific color for descriptions in permanent boxes */
.permanent-description {
    color: #cce5ff; /* A light blue to match the theme */
    border-left-color: rgba(74, 144, 226, 0.4);
}

/* Specific color for descriptions in expired boxes */
.expired-description {
    color: #ffbaba; /* A light red */
    border-left-color: rgba(255, 68, 68, 0.4);
}

/* Styling for any links inside a description */
.code-description a {
    color: #F6E261; /* Re-using the bright link color */
    font-weight: bold;
}

/* Specific style for the new Loot/Info button for blacmarket box ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||*/
.bm-loot-info-btn {
    background: linear-gradient(to bottom, #C92B31, #FF7A7F); 
    border: 1px solid #DA0007;
    color: #fff;
}

.bm-loot-info-btn:hover {
    background: linear-gradient(to bottom, #FF7A7F, #C92B31); /* Invert on hover */
}

/* =================================================== */
/*           SMALL KEY INFO BUTTONS                    */
/* =================================================== */
/* Container for the small key info buttons */
.key-info-buttons-container {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-top: 12px; /* Adds space below the "Updated" date */
}

/* Styling for the individual small buttons */
.key-info-btn {
    background: linear-gradient(to bottom, #ff7c00, #e56a00);
    border: 1px solid #ffc600;
    color: #fff;
    padding: 4px 10px; /* Small padding for a small button */
    border-radius: 3px;
    cursor: pointer;
    font-weight: bold;
    font-size: 11px; /* This makes the text very small */
    text-transform: uppercase;
    font-family: 'Chakra Petch', sans-serif;
    text-shadow: 1px 1px 0 #000;
    transition: all 0.2s;
}

.key-info-btn:hover {
    background: linear-gradient(to bottom, #ff8c00, #ff6a00);
    transform: scale(1.05);
    box-shadow: 0 0 6px #ffc600;
}

/* =================================================== */
/*           FLOATING SHARE BUTTON & MENU (CORRECTED)  */
/* =================================================== */
.floating-share-container {
    position: fixed;
    bottom: 70px;  /* Raised up to be above the Kofi button */
    left: 20px;    /* Moved to the LEFT corner */
    z-index: 1002;
    display: flex;
    flex-direction: column;
    align-items: flex-start; /* Aligns items to the LEFT */
}

/* The main "Share It" button */
.share-fab {
    background: linear-gradient(to bottom, #34a853, #1e8e3e);
    border: 2px solid #5bb974;
    color: white;
    width: 130px;
    height: 45px;
    border-radius: 50px; /* Pill shape */
    font-size: 16px;
    font-weight: bold;
    font-family: 'Chakra Petch', sans-serif;
    text-shadow: 1px 1px 0 #000;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.share-fab:hover {
    transform: scale(1.05);
    box-shadow: 0 0 15px #5bb974;
}

/* The pop-up menu container */
.share-menu {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 15px;
    opacity: 0;
    transform: translateY(10px) scale(0.9);
    pointer-events: none;
    transition: opacity 0.2s ease-out, transform 0.2s ease-out;
}

.share-menu.active {
    opacity: 1;
    transform: translateY(0) scale(1);
    pointer-events: auto;
}

/* Individual share buttons inside the menu */
.share-menu-item {
    color: white;
    padding: 10px 20px;
    border-radius: 4px;
    font-weight: bold;
    text-decoration: none;
    text-align: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    transition: transform 0.2s;
    width: 180px;
}

.share-menu-item:hover {
    transform: scale(1.05);
}

.twitter-btn { background: linear-gradient(to bottom, #1DA1F2, #0c85d0); border: 2px solid #1DA1F2; }
.facebook-btn { background: linear-gradient(to bottom, #1877F2, #1056ad); border: 2px solid #1877F2; }

/* This is the lock. It freezes the entire page. */
/* Prevent background zoom when modal is open */
/* Completely lock the background when modal is open */
html.modal-open,
body.modal-open {
    position: fixed;
    width: 100%;
    height: 100%;
    overflow: hidden;
    /* Prevent any text size adjustment */
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
}

/* Allow zooming only in the modal */
.image-preview-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 1000;
    justify-content: center;
    align-items: center;
    overflow: auto;
    -webkit-overflow-scrolling: touch;
    /* Allow zooming in the modal container */
    touch-action: pan-x pan-y pinch-zoom;
}

.image-preview-content {
    position: relative;
    max-width: 95%;
    max-height: 95%;
    margin: 20px;
    /* Ensure zooming works on content */
    transform-origin: center center;
}

    </style>
</head>
<!-- REVERT TO THIS ORIGINAL HTML STRUCTURE -->
<div id="image-preview-modal" class="image-preview-modal">
    <div class="image-preview-content">
        <button class="close-preview" onclick="closeImagePreview()">×</button>
        <div id="preview-container" style="display: none;">
        </div>
        <img id="preview-image" src="" alt="Preview" style="display: none;">
    </div>
</div>

<body>
   <script src='https://storage.ko-fi.com/cdn/scripts/overlay-widget.js'></script>
<script>
  kofiWidgetOverlay.draw('xsmashx88x', {
    'type': 'floating-chat',
    'floating-chat.donateButton.text': 'Few Asked<br>Dono Button',
    'floating-chat.donateButton.background-color': '#323842',
    'floating-chat.donateButton.text-color': '#fff'
  });
</script> 
    <div class="noise"></div>
    <div class="scanlines"></div>
    
    <div class="container">
        <div class="title-bar">
            <img src="https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png" alt="Left Icon" class="icon">
            <div class="title-text">SHiFT Code Tracker  + More</div>
            <img src="https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png" alt="Right Icon" class="icon">
        </div>
 

<!-- === START: High-Tech Contact Me Section === -->
<div class="contact-me-section">
<h4 class="contact-me-title">Connect/Contact</h4>
<div class="social-links">
<a href="https://x.com/xsmashx88x" target="_blank">🐦 Twitter</a>
<a href="https://discord.com/users/97484502628052992" target="_blank">💬 Discord</a>
<a href="https://www.reddit.com/user/smashcanuckgamer/" target="_blank">👾 Reddit</a>
</div>
</div>
<!-- === END: High-Tech Contact Me Section === -->

<!-- === START: FLOATING SHARE BUTTON === -->
<div class="floating-share-container">
    <!-- The menu that will pop up -->
    <div class="share-menu" id="shareMenu">
        <a href="https://twitter.com/intent/tweet?url=https://xsmashx88x.github.io/Shift-Codes/&text=Check out this awesome tracker for Borderlands SHiFT Codes!Thanks @xsmashx88x For Making This&hashtags=Borderlands,ShiftCodes,Borderlands4,BL4" class="share-menu-item twitter-btn" target="_blank">
            🐦 Share on X
        </a>
        <a href="https://www.facebook.com/sharer/sharer.php?u=https://xsmashx88x.github.io/Shift-Codes/" class="share-menu-item facebook-btn" target="_blank">
            👍 Share on Facebook
        </a>
    </div>

    <!-- The main button that is always visible -->
    <button class="share-fab" onclick="toggleShareMenu()">
        🔗 Share It
    </button>
</div>
<!-- === END: FLOATING SHARE BUTTON === -->

<!-- NEW SETTINGS BUTTON AND SECTION (Place it here or where you prefer it visually) -->
<button class="info-button" onclick="toggleInfo('settings-section')" id="hideem-toggle-btn">🙈Hide Items|🆕</button>

        <div id="settings-section" class="info-section">
            <div class="info-content">
                <h3>Visibility Settings</h3>
                <p>Choose which elements to hide:</p>
                <div class="setting-item">
                    <input type="checkbox" id="hide-redeem-toggle-btn" onchange="handleSettingChange('redeem-toggle-btn', this.checked)">
                    <label for="hide-redeem-toggle-btn">Hide "How To Redeem" button</label>
                </div>
                    <div class="setting-item">
                    <input type="checkbox" id="hide-rewards-link" onchange="toggleRewardsLink(this.checked)">
                    <label for="hide-rewards-link">🆕|Hide "Click Here | To Redeem Codes"</label>
                </div>
                <div class="setting-item">
                    <input type="checkbox" id="hide-roadmap-btn" onchange="handleSettingChange('roadmap-btn', this.checked)">
                    <label for="hide-roadmap-btn">Hide "View BL4 Roadmap" button</label>
                </div>
                <div class="setting-item">
                    <input type="checkbox" id="hide-maurices-toggle-btn" onchange="handleSettingChange('maurices-toggle-btn', this.checked)">
                    <label for="hide-maurices-toggle-btn">Hide "Mauric's Black Market" button</label>
                </div>
                 <div class="setting-item">
                    <input type="checkbox" id="hide-permanent-toggle-btn" onchange="handleSettingChange('permanent-toggle-btn', this.checked)">
                    <label for="hide-permanent-toggle-btn">Hide "[View] Drops + Limited Time Codes + More" button</label>
                </div>
            </div>
        </div>

<button class="info-button" onclick="toggleInfo('info-section')" id="infofaq-toggle-btn">❗INFO/FAQ❓|🆕</button>

        <div id="info-section" class="info-section">
            <div class="info-content">
                <p><strong>MSG To People Thinking I Want Followers/Money (I Don't) SMFH</strong></p>
                <ul>
                    <li><i>This was not done for followers or fame, its to help people, it sucks to be reported on reddit/fb an few other places :(</i></li>
                    <li><i>Some have wanted to donate/tip, so linked kofi button, this is not something have to do... so don't feel you have to.(</i></li>
                    <li><i>But If you are a good person, really like what I am doing, then feel free to use that button.</i></li>             
                </ul>
                <p><strong>F.A.Q</strong></p>
                <ul>
                    <li>🆕<b>I can find keys faster then then show here : </b> <i>99% Of the time, right when randy post them they go on here, other day was a hour late, however not everyone watches his twitter, checks reddit 24/7 or facebook or others, this was done so users can have days to redeem/track and avoid the bullshit of oh this code is expired but was not marked somewhere. (some of you have said this, I get it if active enough just don't use this then).</i></li>
                    <li><b>Why Was This Made :</b> <i>For peeps to know if codes are expired and be able to copy them more easy via the button.</i></li>
                    <li><b>How are codes put here? :</b> <i>All me, I watch randy's twitter or see them around the net and add them, No auto grab system here.</i></li>            
                </ul>
                <p><strong>PSA</strong></p>
                <ul>
                    <li><b>Gold Keys On Multi Systems :</b><i>if linked multi systems can redeem on each :) from what I hear.</i></li>
                    <li><b>🆕They Don't Show Even Tho Did Redeem Them :</b><i>If the redeem site shows 3 codes lets say the 3 you did, then close and restart your game they should show up.</i></li>
                </ul>
            </div>
        </div>

<button class="info-button" onclick="toggleInfo('changelog-section')" id="changlog-toggle-btn">📋CHANGE LOG🛠️|🆕</button>

        <div id="changelog-section" class="info-section">
            <div class="info-content">
                <p><strong>Change Log | Last Updated : 10/4/2025</strong></p>
                <ul>
                    <li>🆕<b>10/4/2025:</b> Fixed/Added : Lil Tweaks, Added Chest/View Keys Button (links to pics)</li>
                    <li><b>10/2/2025:</b> Fixed/Added : Lil Tweaks</li>
                    <li><b>9/29/2025:</b> Fixed/Added : New Codes, Some Lil Changes.</li>
                    <li><b>9/28/2025:</b> Fixed/Added : Fixed Few Things, Added Wildcard/Encore Boss Info</li>
                    <li><b>9/27/2025:</b> Fixed/Added : Just some small tweaks..</li>
                    <li><b>9/26/2025:</b> Fixed/Added : Few Things... Might or Might Not Notice :)</li>                    
                    <li><b>9/25/2025:</b> Fixed : Should Be More Mobile Friendly</li>
                    <li><b>9/25/2025:</b> Added : Hide Buttons Option (should stick on refresh)</li>  
                    <li><b>9/25/2025:</b> Fixed : Mobile Button Issues For Black Market</li>                     
                    <li><b>9/25/2025:</b> Added : Maurices Black Market, Static View</li>  
                    <li><b>9/25/2025:</b> Added : Maurices Black Market, With Map View</li>                     
                    <li><b>9/24/2025:</b> Fixed time issues</li>            
                    <li><b>9/24/2025:</b> Fixed refresh issue on Android/some browsers</li>
                    <li><b>9/23/2025:</b> Added "Mark as redeemed" feature with local storage</li>
                    <li><b>9/22/2025:</b> Added preview button for image rewards</li>
                    <li><b>9/21/2025:</b> Improved countdown timer functionality</li>
                    <li><b>9/20/2025:</b> Added permanent/unknown expiration codes section</li>
                    <li><b>9/19/2025:</b> Initial website launch with basic functionality</li>
                </ul>
            </div>
        </div>

        <button class="info-button redeem-button" onclick="toggleInfo('redeem-section')" id="redeem-toggle-btn">
            🖥️ HOW TO REDEEM ON CONSOLE 🎮
        </button>

        <div id="redeem-section" class="info-section">
            <div class="info-content">
                <p><strong>In-Game</strong></p>
                <ol>
                    <li>Open the Pause Menu while in-game Or On Main Menu</li>
                    <li>Click "SHiFT"</li>
                    <li>Click "Rewards"</li>
                    <li>Enter codes and redeem them</li>
                </ol>
                <p><strong>Online</strong></p>
                <p>CLICK THAT BUTTON BELOW AND WILL OPEN THE SHIFT REDEEM SITE</p>
            </div>
        </div>

<div id="rewards-container">
    <a href="https://shift.gearboxsoftware.com/rewards" target="_blank" class="rewards-link">
        🔗 CLICK HERE | TO REDEEM CODES 🌐 <br>
        <small style="font-size: 0.9em; opacity: 0.6; color: black;">Opens Official SHIFT Rewards Site</small>
    </a>
</div>

        <button class="roadmap-button" onclick="openRoadmapImage()" id="roadmap-btn">🗺️ VIEW BL4 ROADMAP 🛣️</button>
                <button class="events-button hidden" onclick="openEventsImage()" id="events-btn"></button>
        <!-- END NEW ROADMAP BUTTON -->

      <button class="collapse-btn-BlackMarket" onclick="toggleInfo('black-market-section')" id="maurices-toggle-btn">💵 Maurices Black Market/Boss + WildCard🫰<br> <small style="font-size: 0.7em; opacity: 0.9; ">After Reset, Give Me A Few To Update Images/Info Plz.</small><br>     <small style="font-size: 0.7em; opacity: 0.8; color: ##FF7979;" class="drops-pulse">!Updated 10/2/2025!</small> </button>
        
        <div id="black-market-section" class="info-section">
            <h2  style="font-size: 1.2em;">💵 Maurices Black Market/Boss + Wild Card 🫰</h2>
            <div id="black-market-codes-container">
                <!-- Black Market Vendor will be inserted here by JavaScript -->
            </div>
        </div>

<button class="collapse-btn-Perm" onclick="togglePermanent()" id="permanent-toggle-btn">
    🎁 [View] Drops/Skins + Limited Time Codes + More ⌛
    <br>
    <small style="font-size: 0.9em; opacity: 0.9; color: #14F8FF;" class="drops-pulse">!Updated 10/2/2025!</small>
</button>
        
        <div id="permanent-section" class="permanent-section">
            <h2>🎁 Drops/Skins + Limited Time Codes + More ⌛<br> <small style="font-size: 0.9em; opacity: 0.9; ">Anything Besides Gold Keys Will Go Here</small> </h2>                
            <div id="permanent-codes-container">
                <!-- Permanent codes will be inserted here by JavaScript -->
            </div>
        </div>

<h1>👍 Active BL4 SHiFT Codes (New At Top) 🗝️ <br> <small style="font-size: 0.6em; opacity: 0.9; "> ⬇ Gold Keys Only ⬇ | ⬆ Drops Button For Skins + Others ⬆</small> 
    <br>
    <small style="font-size: 0.7em; opacity: 0.8; color: #FFD114;" class="drops-pulse">!Updated 10/3/2025!</small>
    
    <!-- === NEW BUTTONS CONTAINER === -->
    <div class="key-info-buttons-container">
        <button class="key-info-btn" onclick="openImagePreview('https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/seekeysyouhave.png')">
            Check Gold Keys
        </button>
        <button class="key-info-btn" onclick="openImagePreview('https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/%5BDate%20%202025-10-04%5D%20%2B%20%5BTime%20%2003-32-50AM%5D.png')">
            Find Gold Chest
        </button>
    </div>
</h1>
        <div id="active-codes-container">
            <!-- Active codes will be inserted here by JavaScript -->
        </div>

        <button class="collapse-btn-exp" onclick="toggleExpired()">
            ❌ Expired Ish 😭
        </button>
        
        <div id="expired-section" class="expired-section">
            <h3>❌ Expired Ish : Damn Look At Them All 👎</h3>
            <div id="expired-codes-container">
                <!-- Expired codes will be inserted here by JavaScript -->
            </div>
        </div>
    </div>

    <script>

/* mobile image zoom fix maybe */
        

// --- SCRIPT FOR FLOATING SHARE BUTTON (CORRECTED) ---
const shareFab = document.querySelector('.share-fab');
const shareMenu = document.getElementById('shareMenu');

// This function handles opening and closing the menu
function toggleShareMenu(event) {
    // This stops the click from immediately being caught by the 'window' listener
    event.stopPropagation(); 
    shareMenu.classList.toggle('active');
}

// Add the click listener directly to the button
shareFab.addEventListener('click', toggleShareMenu);

// This listener closes the menu if you click anywhere else
window.addEventListener('click', function(event) {
    // If the menu is active and the click was NOT inside the menu itself
    if (shareMenu.classList.contains('active') && !shareMenu.contains(event.target)) {
        shareMenu.classList.remove('active');
    }
});

// --- ADD THIS FUNCTION for the new floating panel refresh and thanks ---

        function toggleThankYouPanel(linkElement) {
            // Finds the main container (.floating-info-panel) and adds/removes the 'is-open' class
            const panel = linkElement.closest('.floating-info-panel');
            if (panel) {
                panel.classList.toggle('is-open');
            }
        }

// ==================== 12-HOUR FORMAT HELPER ====================
// This function correctly handles 12-hour AM/PM and 1-indexed months (1=Jan, 12=Dec).
function createDate(year, month, day, hour, minute, second, isPM) {
    // Convert 12-hour format to 24-hour format
    let hour24 = hour;
    if (isPM && hour < 12) {
        hour24 = hour + 12;
    } else if (!isPM && hour === 12) {
        hour24 = 0; // 12 AM = 0 hours
    }
    // Month is 0-indexed in JavaScript (0=January, 11=December)
    return new Date(year, month - 1, day, hour24, minute, second);
}

//** Hide Redeem shift button **///
function toggleRewardsLink(isChecked) {
  // Find the div with the id 'rewards-container'
  const rewardsDiv = document.getElementById('rewards-container');

  // If the checkbox is checked (isChecked is true)
  if (isChecked) {
    // Hide the div
    rewardsDiv.style.display = 'none';
  } else {
    // Otherwise, show the div
    rewardsDiv.style.display = 'block';
  }
}

// ==================== CONFIGURATION ====================
const ALL_CODES_CONFIG = [
            {
        code: "T9XTB-93BC3-56T35-TBBJT-KF5TW",
        expires: createDate(2025, 10, 6, 1, 37, 0, 0), // 
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1974287733985325112" target="_blank">Via Twit</a>',
        dateAdded: "2025-10-3",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
        {
        code: "TZRBJ-3KTWT-KX3BC-TT3TB-B9ZSK",
        expires: createDate(2025, 10, 6, 1, 37, 0, 0), // 
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1974287733985325112" target="_blank">Via Twit</a>',
        dateAdded: "2025-10-3",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
        {
        code: "3HR33-KWBKT-KRJ3W-JBBTJ-FSTC3",
        expires: createDate(2025, 10, 6, 1, 37, 0, 0), // 
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1974287733985325112" target="_blank">Via Twit</a>',
        dateAdded: "2025-10-3",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
                {
        code: "TZFT3-K9Z33-5FT3W-BJ33T-WZ5X5",
            expires: createDate(2025, 10, 3, 9, 35, 0, 1), // 
        dateAdded: "2025-10-1",
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1973200166888104169" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
            {
        code: "J9RT3-RBJ5T-WRTBK-JB3J3-5TB3R",
        expires: createDate(2025, 10, 3, 9, 35, 0, 1), // 
        dateAdded: "2025-10-1",
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1973200166888104169" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
            {
        code: "TH6BJ-WJTC3-W6B3C-3TTBT-5HTTH",
        expires: createDate(2025, 10, 3, 9, 35, 0, 1), // 
        dateAdded: "2025-10-1",
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1973200166888104169" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
            {
        code: "3HXTT-JBJCT-CR33W-JJTJJ-BCR5W",
        expires: createDate(2025, 10, 2, 9, 35, 0, 1), // 
                dateAdded: "2025-09-30",
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1973200166888104169" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
           {
        code: "BH6TJ-Z993B-5RJBK-JT3B3-RXT3Z",
        expires: createDate(2025, 10, 3, 9, 35, 0, 1), // 
        dateAdded: "2025-10-1",
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1973200020347428912" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
        {
        code: "3S6TT-RSHJ3-WFJ3K-BBJB3-W5ZKS",
        expires: createDate(2025, 10, 3, 9, 35, 0, 1), // 
        dateAdded: "2025-10-1",
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1973200020347428912" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
        {
        code: "JH6BB-6RST3-5FB35-JT3BB-R3WCB",
        expires: createDate(2025, 9, 29, 4, 45, 0, 1), // 
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1972042073701528063" target="_blank">Via Twit</a>',
        dateAdded: "2025-09-27",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
        {
        code: "JZRTJ-SR9BB-W6T35-BJBTT-36FZR",
        expires: createDate(2025, 9, 29, 4, 45, 0, 1), // 
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1972042073701528063" target="_blank">Via Twit</a>',
        dateAdded: "2025-09-27",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
        {
        code: "BSFTB-TZ9BB-KRJBK-TTJB3-6S3KS",
        expires: createDate(2025, 9, 29, 4, 45, 0, 1), // 
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1972042073701528063" target="_blank">Via Twit</a>',
        dateAdded: "2025-09-27",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
    {
        code: "BHRBJ-ZWHT3-W6JBK-BT3BB-CW3ZK",
        expires: createDate(2025, 9, 26, 4, 19, 0, 1), // 4:19 PM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1970946292131188745" target="_blank">Via Twit</a>',
        dateAdded: "2025-09-24",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
    {
        code: "JSX3J-B6SBJ-CXTBC-B3T3B-BZZZT",
        expires: createDate(2025, 9, 26, 4, 19, 0, 1), // 4:19 PM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1970946292131188745" target="_blank">Via Twit</a>',
        dateAdded: "2025-09-24",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "BHFJ3-WXHBB-W63JK-B33B3-5HX95",
        expires: createDate(2025, 9, 26, 4, 19, 0, 1), // 4:19 PM
        title: '1 Gold Key- <a href="https://x.com/DuvalMagic/status/1970946292131188745" target="_blank">Via Twit</a> | 9/24/2025',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "J9XBB-KK9T3-CRTBW-BBT3T-KTBTW",
        expires: createDate(2025, 9, 24, 12, 28, 0, 1), // 12:28 PM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1970163226441547832" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png",
        showCopyButton: true
    },
    {
        code: "JHFTJ-R5HBT-KF3TK-TBJT3-JJTHH",
        expires: createDate(2025, 9, 24, 12, 28, 0, 1), // 12:28 PM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1970163226441547832" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "T9RJB-BFKRR-3RBTW-B33TB-KCZB9",
        title: '1 Gold Key',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/skulliconkey.png"
    },
    {
        code: "THRBT-WW6CB-56TB5-3B3BJ-XBW3X",
        expires: createDate(2025, 9, 30, 0, 0, 0, 1), // Fixed: September 30, 2025 (month is 0-indexed)
        title: '1 Gold Key',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "3H63J-Z3S3J-KR3BK-BTJ33-ZWKTK",
        expires: createDate(2025, 9, 22, 12, 36, 0, 1), // 12:36 PM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1969440522528792653" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "TSR3B-J5S3T-KRBJW-BTTBJ-JRCXX",
        expires: createDate(2025, 9, 22, 12, 36, 0, 1), // 12:36 PM
        title: '1 : Gold Key - <a href="https://x.com/DuvalMagic/status/1969440522528792653" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "3ZXJB-53STT-56T3W-B3TT3-HTS95",
        expires: createDate(2025, 9, 21, 11, 58, 1, 1), // 11:58 AM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1969068501215170641" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "BSRT3-FTZBJ-K6BTW-JB3T3-WXT99",
        expires: createDate(2025, 9, 21, 11, 58, 1, 1), // 11:58 AM
        title: '1 Gold Key - <a href="https://x.com/DuvalMagic/status/1969068501215170641" target="_blank">Via Twit</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "B9XT3-HX6TT-W6BBW-TTJT3-JTFKX",
        expires: createDate(2025, 9, 10, 12, 0, 0, 0), // September 10, 2025, 12:00 PM (no isPM specified, defaults to AM)
        title: "1 Gold Key",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },              
    {
        code: "39RTT-3ZR3T-5FJBK-3J3J3-C5CRT",
        expires: createDate(2025, 9, 10, 12, 0, 0, 0), // September 10, 2025, 12:00 PM
        title: "1 Gold Key",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },          
    {
        code: "WHWJB-XH3SX-39CZW-H3BBB-BTF55",
        expires: createDate(2025, 9, 10, 12, 0, 0, 0), // September 10, 2025, 12:00 PM
        title: "1 Gold Key",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },          
    {
        code: "3SR3J-CS63T-CFB3K-J3JTT-RZ5JR",
        expires: createDate(2025, 9, 10, 12, 0, 0, 0), // September 10, 2025, 12:00 PM
        title: "1 Gold Key",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "3SRBB-X9RBJ-CRTBW-3BBB3-KJFW6",
        expires: createDate(2025, 9, 10, 12, 0, 0, 0), // September 10, 2025, 12:00 PM
        title: "1 Gold Key",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    },
    {
        code: "WEWJB-XH3SX-39CZW-H3BBB-BPF55",
        expires: createDate(2025, 9, 20, 12, 0, 0, 0), // September 20, 2025, 12:00 PM
        title: '1 Gold Key - Requires linked My2K Games account - <a href="https://shift.gearboxsoftware.com/associations" target="_blank">Associate Account</a>',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/blkey50.png"
    }       
];

const PERMANENT_CODES = [
        {
        code: "No Code",
        title: 'Twitch Drops : Watch, Drop, and Roll ECHO-4 Drone Skin cosmetic',
        description:'<a href="https://borderlands.2k.com/twitch-drops/" target="_blank">Read About It Here Or Via Info Below</a><br><br>Sep  27, 2025 - Oct 25, 2025<br><br>• Watch any livestream in the Borderlands 4 category on the official <a href="http://twitch.tv/Borderlands" target="_blank">Borderlands 4 Twitch channel</a> or <a href="https://www.twitch.tv/gearboxofficial" target="_blank">Gearbox Twitch channel</a> for 15 minutes and claim the reward',        
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/twitchicon%20(Custom).png",
        showCopyButton: false,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/bl4promoimages/BL4_Echobot_Drop_Wide_textless.png",
        expires: createDate(2025, 10, 25, 2, 59, 0, 1) // 
    },
            {
        code: "TZXT3-XJXCB-CXBJW-BTTJT-9SK6B",
        title: 'Rafas Savings Savior | Vault Hunter Skin',
        description: 'Community Challenge : Get 20 million Second Winds from Sep. 26-28 as Rafa<br><a href="https://x.com/Borderlands/status/1971651935104098527" target="_blank">Link To Tweet</a> ',
        dateAdded: "9/27/2025",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/bl4icon%20(GitHub%20icon).png",
        showCopyButton: true,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/bl4promoimages/G1y2OQYXEAAqQVZ.jpeg",
        expires: createDate(2030, 12, 31, 0, 0, 0, 0) // September 29, 2025, midnight AM (explicitly set to avoid default issues)
    },
        {
        code: "No Code",
        title: 'Discord  |  Borderlands Bundles + Single Items',
        description:'Click On Shop, Look for the Borderlands 4 Image or Scroll down and will find it. <br>Items Range from $10.99CAD to $5.99CAD Being The Lowest<br><br>NO ETA ON WHEN IT GOES AWAY, COULD BE A WEEK OR MONTH OR MONTHS FROM NOW<br><br> [Click the preview button to see video of the effects]',        
        dateAdded: "9/26/2025",
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/discordicon%20(Custom).png",
        showCopyButton: false,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/bl4promoimages/smaller%20%20cbr%20%20%20%202025-09-26%2012-09-25_1.mp4",
    },
    {
        code: "No Code",
        title: 'Twitch Drops 2 : Forsaken Chaos Legendary shotgun',
        description:'<a href="https://borderlands.2k.com/twitch-drops/" target="_blank">Read About It Here Or Via Info Below</a><br><br>September 11, 2025 - September 30, 2025<br><br>• Watch any Borderlands 4 Twitch livestream in the <a href="https://www.twitch.tv/directory/category/borderlands-4" target="_blank">Borderlands 4 category</a> for 2 hours and claim the reward',        
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/twitchicon%20(Custom).png",
        showCopyButton: false,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/bl4promoimages/BL4_ForsakenChaos.png",
        expires: createDate(2025, 9, 30, 0, 0, 0, 0) // September 30, 2025, midnight AM
    },
    {
        code: "No Code",
        title: 'Twitch Drops 3 : Midnight Defiance Legendary sniper rifle',
        description:'<a href="https://borderlands.2k.com/twitch-drops/" target="_blank">Read About It Here Or Via Info Below</a><br><br>September 11, 2025 - September 30, 2025<br><br>• Watch any Borderlands 4 Twitch livestream in the <a href="https://www.twitch.tv/directory/category/borderlands-4" target="_blank">Borderlands 4 category</a> hosted by a <a href="https://borderlands.2k.com/borderlands-4/partnered-creators/" target="_blank">partnered creator</a> for 2 hours and claim the reward',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/twitchicon%20(Custom).png",
        showCopyButton: false,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/bl4promoimages/BL4_MidnightDefiance.png",
        expires: createDate(2025, 9, 30, 0, 0, 0, 0) // September 30, 2025, midnight AM
    },
    {
        code: "JS63J-JSCWJ-CFTBW-3TJ3J-WJS5R",
        title: 'Break Free cosmetics pack and Legendary Ripper shield <br><br>• [Break Free] Vault Hunter Skin (for Vex, Rafa, Amon, and Harlowe)<br>• [Firebreak] Legendary Ripper Shield (with minimum level of 25)<br>• [Break Free] ECHO-4 Drone Skin<br>• [Kn0x] ECHO-4 Drone Skin',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/bl4icon%20(GitHub%20icon).png",
        showCopyButton: true,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/bl4promoimages/breakfree.png",
        expires: createDate(2031, 1, 1, 2, 45, 0, 1) // Fixed: December 31, 2030, midnight AM
    },
    {
        code: "NO CODE - SIGNED UP AN IS SENT",
        title: 'Butterfinger ECHO-4 Drone Skin',
        description:'This shift code is can be acquired in two ways<br>Enter the  <a href="https://www.gamewithbutterfinger.com/home?path=Echo4" target="_blank">Butterfinger x Borderlands 4 online sweepstakes. </a> Note that theres no guarantee this will be available after September 2025. (US Only) <br> By purchasing the <a href="https://www.gamestop.com/collectibles/collectors-boxes/products/borderlands-4-echo-4-bundle-gamestop-exclusive/426330.html" target="_blank">GameStop Madrinas Coffee Collectors Box (US Only).</a> <br><i>USE A VPN, then search and use a fake usa number/address gen, if live outside the usa, Its what I did and I  got emailed the key :)</i>" ',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/bl4icon%20(GitHub%20icon).png",
        showCopyButton: false,
        showPreviewButton: true,
        imagePreview: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/bl4promoimages/butter%20fingers%20skin.png",
        expires: createDate(2025, 9, 22, 0, 0, 0, 0) // September 22, 2025, midnight AM
    }
];


// ==================== BLACK MARKET VENDOR SYSTEM ====================
const BLACK_MARKET_VENDORS = [
    {
        code: "Black Market Vendor",
        title: 'Maurices Black Market - Refreshes every Thursday at 12:00 PM EDT',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/MauricesBlackMarket.png",
        description:'<b>Static Image Button</b> : <i>Is where he is</i><br><br><b>View Location (MAP)</b> : <i>It Shows few Spots He Can Be <br> <br> If Static Button Is Missing, Means Update Is Happening</i>',
        showCopyButton: false,
        showPreviewButton: true,
        mapGenieLocation: "https://mapgenie.io/borderlands-4/maps/kairos?embed=light&catIds=13472",
        staticImageLocation: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/bmvendorlocation/bl4bmvendor%20-%20Idolator%E2%80%99s%20Noose%20province%20in%20the%20Fadefields%20region.png",
        staticImageCredit: 'Static Image From : <a href="https://mentalmars.com/borderlands-4/loot/black-market/" target="_blank">MentalMars (Check Them Out)</a>',
        type: 'weekly-vendor'
    },
    {
        code: "Weekly WildCard Mission",
        title: 'Means Of Ascent : Weekly Wild Card - Refreshes every Thursday at 12:00 PM EDT',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/weeklymission.png",
        description:'<b>Drop</b> : <i>Star Helix (Daedalus Assault Rifle)</i><br><br><b>Where To Go?</b> : <i>Start the mission via the conrner of the map via the button there, It will reload the map and can track an get to the mission.<br><br>PS : If any of the 3 buttons are missing, means still updating</i>', // <--- COMMA ADDED HERE
        showCopyButton: false,
        showPreviewButton: true,
        loot: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/weeklyweapons/Star%20Helix%20-%20weapon.png",
        infoUrl: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/weeklyact/means%20of%20ascent%20-%20info%20card.png",
        staticImageLocation: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/weeklyact/means%20of%20ascent%20-%20location.png",
        staticImageCredit: 'Image Credit : Me,Others',
        type: 'weekly-vendor'
    },
    {
        code: "Weekly Big Encore Boss",
        title: 'Driller Hole : Big Encore Boss - Refreshes every Thursday at 12:00 PM EDT',
        icon: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/BigEncoreBoss.png",
        loot: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/weeklyweapons/oct2oct9thencoreloot.gif",
        description:'<b>Drops</b> : <i>G.M.R assault rifle, Katagawas Revenge sniper, and Fuse grenade.</i> <br><br> <b>Location : </b><i>Tonnage Peel and lower section of that area <br><br>PS : No Info For Drops/Location Its Being Updated</i>', // <--- COMMA ADDED HERE
        showCopyButton: false,
        showPreviewButton: true,
        staticImageLocation: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/weeklyact/Driller%20Hole%20-%20Encore%20location.png",
        staticImageCredit: '<b>TIP :</b> <i>If you dont see the skull with hat icon, just means you have not done anything around there... use image button an go to around that area :)</i> <br> <b>Image Credit : </b><i>Me,Others</i>',
        type: 'weekly-vendor'
    }
    // You can add more vendor objects here, separated by commas
];

const ROADMAP_CONFIG = {
    imageUrl: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/bm-images/bl4promoimages/roadmap.png", // <--- CHANGE THIS TO YOUR ACTUAL ROADMAP IMAGE URL
};

const EVENTS_CONFIG = {
    imageUrl: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/bm-images/weeklyeventchal/oct3oct5chal.png", // <-- PASTE YOUR EVENT IMAGE URL HERE
    buttonText: "🎉 VIEW CURRENT EVENT/CHALLENGE 📅<br>Oct3/Oct5" // <-- EDIT THE BUTTON TEXT HERE
};

const BLACK_MARKET_EXTRA_CONFIG = {
    imageUrl: "https://raw.githubusercontent.com/xsmashx88x/Shift-Codes/refs/heads/gh-pages/BL4-Black-Market-Location-003-Grindstone-of-the-Worthysep25-oct2.jpg", // <--- !!! REPLACE THIS WITH THE ACTUAL IMAGE URL !!!
};
        // =======================================================  

        // Helper function to format the date added
         // =======================================================
        //      FINAL: SMART & MANUAL DATE ADDED FUNCTION
        // =======================================================
        /**
         * A smart function that gets and formats the "Added On" date based on specific rules:
         * - If `dateAdded` is a valid date string, it's used.
         * - If `dateAdded` is an empty string (""), it auto-generates today's date.
         * - If the `dateAdded` property is completely missing, it does nothing.
         * @param {object} codeData - The entire code object from your config.
         * @returns {string} - The formatted date string (e.g., "Sep 27, 2025") or an empty string.
         */
function getFormattedDateAdded(codeData) {
            // Check if the dateAdded property exists and has a value.
            if (codeData.hasOwnProperty('dateAdded') && codeData.dateAdded.trim() !== '') {
                // If it exists, return the text exactly as you wrote it.
                return codeData.dateAdded;
            }
            
            // If the property is missing or the string is empty, return nothing.
            return '';
        }


// Helper for Black Market Vendor's weekly refresh
        function getNextVendorRefresh() {
            const now = new Date();
            const nextRefresh = new Date(now);
            
            // Set target day (Thursday = 4) and time (12:00 PM)
            const targetDay = 4; // Thursday (Sunday is 0, Monday is 1, ..., Saturday is 6)
            const targetHour = 12; // 12 PM in 24-hour format
            const targetMinute = 0;
            
            // Calculate days until next Thursday
            let daysUntilTarget = (targetDay + 7 - now.getDay()) % 7;
            
            // If it's the same day, check if the time has already passed
            if (daysUntilTarget === 0) {
                if (now.getHours() > targetHour || 
                    (now.getHours() === targetHour && now.getMinutes() >= targetMinute)) {
                    daysUntilTarget = 7; // If the time has passed, schedule for the next week
                }
            }
            
            // Set the next refresh date
            nextRefresh.setDate(now.getDate() + daysUntilTarget);
            nextRefresh.setHours(targetHour, targetMinute, 0, 0);
            
            return nextRefresh;
        }

function createBlackMarketVendorBox(vendorData, index) {
    const nextRefresh = getNextVendorRefresh();
    const now = new Date();
    const timeLeft = nextRefresh.getTime() - now.getTime();
    
    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
    
const iconHtml = createIconHtml(vendorData.icon, false, 'blackmarket');
    
    const uniqueId = vendorData.code.replace(/\s+/g, '-') + '-' + index;
    const isRedeemed = getRedemptionStatus(uniqueId);
    const redeemedClass = isRedeemed ? 'redeemed' : '';

    // --- Logic for ALL optional buttons ---
    let lootButtonHtml = '';
    let infoButtonHtml = ''; // <--- NEW INFO BUTTON VARIABLE
    let staticImageButtonHtml = '';
    let mapGenieButtonHtml = '';

    // LOOT Button logic (only show if vendorData.loot is a non-empty string)
    if (vendorData.loot && vendorData.loot.trim() !== '') {
        lootButtonHtml = `
            <button class="bm-small-btn bm-loot-info-btn" onclick="openImagePreview('${vendorData.loot}')">
                💰 View Loot
            </button>
        `;
    }

    // NEW: INFO Button logic (only show if vendorData.infoUrl is a non-empty string)
    if (vendorData.infoUrl && vendorData.infoUrl.trim() !== '') {
        infoButtonHtml = `
            <button class="bm-small-btn bm-loot-info-btn" onclick="openImagePreview('${vendorData.infoUrl}')">
                📰 View Info
            </button>
        `;
    }
    // END NEW LOGIC

    if (vendorData.staticImageLocation) {
        staticImageButtonHtml = `
            <button class="bm-small-btn bm-static-image-btn" onclick="openImagePreview('${vendorData.staticImageLocation}')">
                📍 View Location (STATIC)
            </button>
        `;
    }

    if (vendorData.mapGenieLocation) {
        mapGenieButtonHtml = `
            <button class="bm-small-btn bm-mapgenie-btn" onclick="openImagePreview('${vendorData.mapGenieLocation}')">
                📍 View Location (MAP)
            </button>
        `;
    }
    
    let descriptionHtml = '';
    if (vendorData.description) {
        descriptionHtml = `<div class="code-description">${vendorData.description}</div>`;
    }

    // --- HTML STRUCTURE UPDATED BELOW ---
    return `
        <div class="black-market-code-box ${redeemedClass}" id="black-market-vendor-${index}">
            <div class="code-header">
                ${iconHtml}
                <div class="title-container">${vendorData.title}</div>
            </div>
            
            <div class="code-text">${vendorData.code}</div>
            
            <!-- Description is now here, after the title and code -->
            ${descriptionHtml}
            
            <div class="expire-date">Next refresh: ${formatDate(nextRefresh)}</div>
            <div class="countdown" data-refreshtime="${nextRefresh.getTime()}">Refreshes in: ${days}d ${hours}h ${minutes}m ${seconds}s</div>
            ${vendorData.staticImageCredit ? `<div class="black-market-credit">${vendorData.staticImageCredit}</div>` : ''}
            <div class="code-footer">
                <div class="black-market-buttons-group">
                    ${lootButtonHtml}
                    ${infoButtonHtml}  <!-- <--- INSERTED NEW INFO BUTTON HERE -->
                    ${staticImageButtonHtml}
                    ${mapGenieButtonHtml}
                </div>
                <div class="bmredeem-checkbox">
                    <input type="checkbox" id="bm-redeemed-${index}" ${isRedeemed ? 'checked' : ''} 
                        onchange="handleRedemptionChange('${uniqueId}', this, document.getElementById('black-market-vendor-${index}'))">
                    <label for="bm-redeemed-${index}">💰</label>
                </div>
            </div>
        </div>
    `;
}

function updateVendorTimer() {
    // Find ALL vendor boxes on the page that have a countdown element
    const vendorBoxes = document.querySelectorAll('.black-market-code-box .countdown');
    
    vendorBoxes.forEach(countdownElement => {
        const vendorBox = countdownElement.closest('.black-market-code-box');
        if (!vendorBox) return;

        const nextRefresh = getNextVendorRefresh();
        const now = new Date();
        const timeLeft = nextRefresh.getTime() - now.getTime();

        // Handle case where refresh just occurred
        if (timeLeft <= 0) {
            try {
                // 1. Get the existing redemption data object from localStorage
                const redeemedCodes = JSON.parse(localStorage.getItem('shiftRedeemedCodes')) || {};

                // 2. Loop through the BLACK_MARKET_VENDORS config to find the keys that need to be deleted
                BLACK_MARKET_VENDORS.forEach((vendorData, index) => {
                    // 3. Recreate the unique ID used as the key, e.g., "Black-Market-Vendor-0"
                    const uniqueId = vendorData.code.replace(/\s+/g, '-') + '-' + index;
                    
                    // 4. If that key exists in our redemption object, delete it
                    if (redeemedCodes.hasOwnProperty(uniqueId)) {
                        delete redeemedCodes[uniqueId];
                    }
                });

                // 5. Save the modified object (with the vendor keys removed) back to localStorage
                localStorage.setItem('shiftRedeemedCodes', JSON.stringify(redeemedCodes));

                console.log("Black Market Vendor refreshed and redemption statuses cleared. Reloading page...");
            } catch (e) {
                console.error("Error clearing Black Market redemption statuses:", e);
            } finally {
                // 6. Reload the page to show the new vendor data and unchecked boxes
                location.reload();
            }
            return; // Stop further execution as the page will reload
        }
        
        const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
        const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
        
        const expireDateElement = vendorBox.querySelector('.expire-date');
        
        countdownElement.textContent = `Refreshes in: ${days}d ${hours}h ${minutes}m ${seconds}s`;
        
        if (expireDateElement) {
            expireDateElement.textContent = `Next refresh: ${formatDate(nextRefresh)}`;
        }
    });
}
        // Make sure to call updateVendorTimer regularly (e.g., every second)
        setInterval(updateVendorTimer, 1000);

function openImagePreview(url) {
    // --- START: Turn the lock ON ---
    document.documentElement.classList.add('modal-open');
    document.body.classList.add('modal-open');
    // REMOVE viewport modification entirely - let the modal handle its own zoom
    // --- END: Turn the lock ON ---

    // Rest of your function remains exactly the same...
    const modal = document.getElementById('image-preview-modal');
    const imageElement = document.getElementById('preview-image');
    const container = document.getElementById('preview-container');
    
    imageElement.style.display = 'none';
    container.style.display = 'none';
    
    if (url.match(/\.(jpeg|jpg|gif|png|svg|webp)$/i)) {
        imageElement.src = url;
        imageElement.style.display = 'block';
    } else if (url.match(/\.(mp4|webm|ogg)$/i)) {
        container.innerHTML = `<video controls autoplay style="width: 100%; height: 100%;"><source src="${url}" type="video/mp4"></video>`;
        container.style.display = 'block';
    } else {
        container.innerHTML = `<iframe src="${url}" style="width: 100%; height: 100%;"></iframe>`;
        container.style.display = 'block';
    }
    
    modal.style.display = 'flex';
}
        // --- NEW: Function to open the Roadmap image ---
function openRoadmapImage() {
    openImagePreview(ROADMAP_CONFIG.imageUrl);
}

function openEventsImage() {
    openImagePreview(EVENTS_CONFIG.imageUrl);
}


        function setupOptionalButtons() {
            const eventsButton = document.getElementById('events-btn');
            // Check if the imageUrl is not null and not an empty string
            if (EVENTS_CONFIG.imageUrl && EVENTS_CONFIG.imageUrl.trim() !== "") {
                // If we have a URL, set the button text and make it visible
                eventsButton.innerHTML = EVENTS_CONFIG.buttonText;
                eventsButton.classList.remove('hidden');
            }
        }


        function showPreviewFallback(url) {
            const container = document.getElementById('preview-container');
            container.innerHTML = `
                <div style="color: white; text-align: center; padding: 40px;">
                    <h3>🌐 Cannot Embed Website</h3>
                    <p>Click below to open in new tab:</p>
                    <button onclick="window.open('${url}', '_blank'); closeImagePreview();" 
                            style="background: #ffc600; color: black; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">
                        Open MapGenie
                    </button>
                </div>
            `;
        }

function closeImagePreview() {
    // --- START: Turn the lock OFF ---
    document.documentElement.classList.remove('modal-open');
    document.body.classList.remove('modal-open');
    // No viewport changes needed
    // --- END: Turn the lock OFF ---

    document.getElementById('image-preview-modal').style.display = 'none';
}

    /* end of close image preview */

        function toggleInfo(sectionId) {
            const section = document.getElementById(sectionId);
            section.classList.toggle('show');
        }

        function toggleExpired() {
            const expiredSection = document.getElementById('expired-section');
            expiredSection.classList.toggle('show');
        }

        function togglePermanent() {
            const permanentSection = document.getElementById('permanent-section');
            permanentSection.classList.toggle('show');
        }

        function copyToClipboard(text, index, type) {
            navigator.clipboard.writeText(text).then(() => {
                const message = document.getElementById(`copied-${type}-${index}`);
                if (message) {
                    message.style.display = 'inline';
                    setTimeout(() => {
                        message.style.display = 'none';
                    }, 2000);
                }
            }).catch(err => {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                const message = document.getElementById(`copied-${type}-${index}`);
                if (message) {
                    message.style.display = 'inline';
                    setTimeout(() => {
                        message.style.display = 'none';
                    }, 2000);
                }
            });
        }

        function saveRedemptionStatus(code, isRedeemed) {
            try {
                const redeemedCodes = JSON.parse(localStorage.getItem('shiftRedeemedCodes')) || {};
                redeemedCodes[code] = isRedeemed;
                localStorage.setItem('shiftRedeemedCodes', JSON.stringify(redeemedCodes));
            } catch (e) {
                console.error("Error saving to localStorage:", e);
            }
        }

        function getRedemptionStatus(code) {
            try {
                const redeemedCodes = JSON.parse(localStorage.getItem('shiftRedeemedCodes')) || {};
                return redeemedCodes[code] || false;
            } catch (e) {
                console.error("Error reading from localStorage:", e);
                return false;
            }
        }

        function handleRedemptionChange(code, checkbox, container) {
            const isRedeemed = checkbox.checked;
            saveRedemptionStatus(code, isRedeemed);
            
            if (isRedeemed) {
                container.classList.add('redeemed');
            } else {
                container.classList.remove('redeemed');
            }
        }

        function handlePermanentRedemptionChange(code, checkbox, container) {
            const isRedeemed = checkbox.checked;
            saveRedemptionStatus(code, isRedeemed);
            
            if (isRedeemed) {
                container.classList.add('permanent-redeemed');
            } else {
                container.classList.remove('permanent-redeemed');
            }
        }

        // New functions for Black Market Vendor redemption status
        function saveBlackMarketRedemptionStatus(isRedeemed) {
            try {
                localStorage.setItem('blackMarketRedeemed', JSON.stringify(isRedeemed));
            } catch (e) {
                console.error("Error saving Black Market redemption status to localStorage:", e);
            }
        }

        function getBlackMarketRedemptionStatus() {
            try {
                const status = localStorage.getItem('blackMarketRedeemed');
                return status ? JSON.parse(status) : false;
            } catch (e) {
                console.error("Error reading Black Market redemption status from localStorage:", e);
                return false;
            }
        }

        function isImageUrl(str) {
            return str.match(/\.(jpeg|jpg|gif|png|svg|webp)$/i) !== null;
        }

// REFINED createIconHtml function
function createIconHtml(icon, isPermanent = false, iconType = null) {
    let baseClassName;

    if (isPermanent) {
        // Permanent codes will use their specific classes
        baseClassName = isImageUrl(icon) ? 'permanent-custom-icon' : 'permanent-key-icon';
    } else if (iconType === 'active-code') {
        // Active codes will use the new active-codes-icon class
        baseClassName = 'active-codes-icon';
    } else if (iconType === 'blackmarket') {
        // Black market codes will use the new blackmarket-icon class
        baseClassName = 'blackmarket-icon';
    } else {
        // Fallback for any other context, using the original custom/key icons
        // This handles cases where you might call createIconHtml without a specific iconType
        baseClassName = isImageUrl(icon) ? 'custom-icon' : 'key-icon';
    }

    const finalClassName = baseClassName; // In this simple case, finalClassName is just baseClassName

    if (!icon) {
        // Default to a key icon if no icon data is provided
        return `<span class="${finalClassName}">🔑</span>`;
    } else if (isImageUrl(icon)) {
        return `<img src="${icon}" class="${finalClassName}" alt="Icon">`;
    } else {
        // It's text/emoji
        return `<span class="${finalClassName}">${icon}</span>`;
    }
}

        // --- MODIFIED organizeCodes function for robust date comparison and error handling ---
        // --- MODIFIED organizeCodes function for robust date comparison and error handling ---
        function organizeCodes() {
            const now = new Date();
            const nowTimestamp = now.getTime(); // Get timestamp once for consistent comparison
            const regularActiveCodes = [];
            const permanentActiveCodes = [];
            const expiredCodes = [];

            // Process ALL_CODES_CONFIG (regular codes)
            ALL_CODES_CONFIG.forEach(codeData => {
                
                // --- FIX STARTS HERE ---
                // First, check if the 'expires' property even exists.
                // If it doesn't, we know it's a permanent active code.
                if (!codeData.expires) {
                    regularActiveCodes.push(codeData);
                    return; // Move to the next code in the loop
                }
                // --- FIX ENDS HERE ---

                // The rest of this logic will now only run for codes that DO have an 'expires' property.
                let expiresDate;
                try {
                    expiresDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                } catch (e) {
                    console.error(`Error parsing expires date for regular code "${codeData.code}":`, codeData.expires, e);
                    expiredCodes.push(codeData);
                    return;
                }

                if (isNaN(expiresDate.getTime())) {
                    console.error("Invalid expires date for regular code (isNaN check):", codeData.code, codeData.expires);
                    expiredCodes.push(codeData);
                    return;
                }

                if (expiresDate.getTime() > nowTimestamp) {
                    regularActiveCodes.push(codeData);
                } else {
                    expiredCodes.push(codeData);
                }
            });

            // Process PERMANENT_CODES (This part remains the same)
            PERMANENT_CODES.forEach(codeData => {
                let expiresDate = null;
                if (codeData.expires) {
                    try {
                        expiresDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                    } catch (e) {
                        console.error(`Error parsing expires date for permanent code "${codeData.code}":`, codeData.expires, e);
                        permanentActiveCodes.push(codeData);
                        return;
                    }

                    if (isNaN(expiresDate.getTime())) {
                        console.error("Invalid expires date for permanent code (isNaN check):", codeData.code, codeData.expires);
                        permanentActiveCodes.push(codeData);
                        return;
                    }
                }
                
                if (!expiresDate || expiresDate.getTime() > nowTimestamp) {
                    permanentActiveCodes.push(codeData);
                } else { 
                    expiredCodes.push({
                        ...codeData,
                        wasPermanent: true
                    });
                }
            });
            
            return { regularActiveCodes, permanentActiveCodes, expiredCodes };
        }

        function formatDate(date) {
            // Ensure the date object is valid before formatting
            if (!date || isNaN(date.getTime())) {
                return "Invalid Date";
            }
            // Convert to user's local time with clear timezone info
            const userLocalTime = date.toLocaleString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZoneName: 'short'
            });
            
            // Get the user's timezone
            const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            
            return `${userLocalTime} (Your Timezone: ${userTimezone})`; 
        }

        function createPermanentCodeBox(codeData, index) {
            const hasCopyButton = codeData.showCopyButton !== false;
            const hasPreviewButton = codeData.showPreviewButton;
            const isRedeemed = getRedemptionStatus(codeData.code);
            const redeemedClass = isRedeemed ? 'permanent-redeemed' : '';
            const iconHtml = createIconHtml(codeData.icon, true);
            
            const descriptionHtml = codeData.description ? `<div class="code-description permanent-description">${codeData.description}</div>` : '';

            // --- SIMPLIFIED DATE LOGIC ---
            const formattedDate = getFormattedDateAdded(codeData);
            const dateAddedHtml = formattedDate ? `<div class="date-added">Added Here On : ${formattedDate}</div>` : '';
            // --- END OF SIMPLIFIED LOGIC ---

            let countdownHtml = '';
            let expiresDate = null;
            if (codeData.expires) {
                // ... (rest of expiration logic is unchanged)
                try { expiresDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires); if (!isNaN(expiresDate.getTime())) { const timeLeft = expiresDate.getTime() - new Date().getTime(); if (timeLeft > 0) { const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24)); const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)); const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60)); countdownHtml = `<div class="countdown">Time left: ${days}d ${hours}h ${minutes}m</div>`; } } } catch (e) { console.error("Error parsing expires date:", e); }
            }
            
            let copyButtonHtml = ''; if (hasCopyButton) { copyButtonHtml = `<button class="permanent-copy-btn" onclick="copyToClipboard('${codeData.code}', ${index}, 'permanent')">COPY</button><span id="copied-permanent-${index}" class="permanent-copied-message">✓ Copied!</span>`; }
            let previewButtonHtml = ''; if (hasPreviewButton && codeData.imagePreview) { previewButtonHtml = `<button class="prempreview-btn" onclick="openImagePreview('${codeData.imagePreview}')">📷 PREVIEW</button>`; }
            
            return `
                <div class="permanent-code-box clearfix ${redeemedClass}" id="permanent-${index}">
                    <div class="permanent-code-header">${iconHtml}<div class="permanent-code-text">${codeData.code}</div></div>
                    ${dateAddedHtml}
                    <div class="permanent-title-container">${codeData.title}</div>
                    ${descriptionHtml}
                    ${expiresDate ? `<div class="expire-date">Expires: ${formatDate(expiresDate)}</div>` : ''}
                    ${countdownHtml}
                    <div class="permanent-code-footer">
                        <div class="permredeem-checkbox"><input type="checkbox" id="permanent-redeemed-${index}" ${isRedeemed ? 'checked' : ''} onchange="handlePermanentRedemptionChange('${codeData.code}', this, document.getElementById('permanent-${index}'))"><label for="permanent-redeemed-${index}">🎁</label></div>
                        ${copyButtonHtml}${previewButtonHtml}
                    </div>
                </div>`;
        }

        function createActiveCodeBox(codeData, index) {
            const hasCopyButton = codeData.showCopyButton !== false;
            const hasPreviewButton = codeData.showPreviewButton;
            const isRedeemed = getRedemptionStatus(codeData.code);
            const redeemedClass = isRedeemed ? 'redeemed' : '';
const iconHtml = createIconHtml(codeData.icon, false, 'active-code');
            
            const descriptionHtml = codeData.description ? `<div class="code-description">${codeData.description}</div>` : '';

            // --- SIMPLIFIED DATE LOGIC ---
            // Call our new merged function to get the final, formatted date.
            const formattedDate = getFormattedDateAdded(codeData);
            const dateAddedHtml = formattedDate ? `<div class="date-added">Added Here On : ${formattedDate}</div>` : '';
            // --- END OF SIMPLIFIED LOGIC ---

            let expirationDetailsHtml = '';
            if (codeData.expires) {
                // ... (rest of expiration logic is unchanged)
                let expiresDate; try { expiresDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires); if (!isNaN(expiresDate.getTime())) { const timeLeft = expiresDate.getTime() - new Date().getTime(); if (timeLeft > 0) { const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24)); const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)); const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60)); expirationDetailsHtml = `<div class="expire-date">Expires: ${formatDate(expiresDate)}</div><div class="countdown">Time left: ${days}d ${hours}h ${minutes}m</div>`; } } } catch (e) { console.error("Error parsing expires date:", e); }
            } else {
                expirationDetailsHtml = `<div class="expire-date">Expires: Never (Permanent Code)</div>`;
            }
            
            let copyButtonHtml = ''; if (hasCopyButton) { copyButtonHtml = `<button class="small-copy-btn" onclick="copyToClipboard('${codeData.code}', ${index}, 'active')">COPY</button><span id="copied-active-${index}" class="copied-message">✓ Copied!</span>`; }
            let previewButtonHtml = ''; if (hasPreviewButton && codeData.imagePreview) { previewButtonHtml = `<button class="activepreview-btn" onclick="openImagePreview('${codeData.imagePreview}')">📷 PREVIEW</button>`; }
            
            return `
                <div class="code-box ${redeemedClass}" id="active-${index}">
                    <div class="code-header">${iconHtml}<div class="title-container">${codeData.title}</div></div>
                    ${dateAddedHtml}
                    ${descriptionHtml}
                    <div class="code-text">${codeData.code}</div>
                    ${expirationDetailsHtml}
                    <div class="code-footer">
                        <div class="actredeem-checkbox"><input type="checkbox" id="redeemed-${index}" ${isRedeemed ? 'checked' : ''} onchange="handleRedemptionChange('${codeData.code}', this, document.getElementById('active-${index}'))"><label for="redeemed-${index}">👍</label></div>
                        <div class="active-code-buttons-group">${previewButtonHtml}${copyButtonHtml}</div>
                    </div>
                </div>`;
        }


        function createExpiredCodeBox(codeData, index) {
            const hasPreviewButton = codeData.showPreviewButton;
            const isRedeemed = getRedemptionStatus(codeData.code);
            const redeemedClass = isRedeemed ? 'redeemed' : '';
            const iconHtml = createIconHtml(codeData.icon, false);
            
            const descriptionHtml = codeData.description ? 
                `<div class="code-description expired-description">${codeData.description}</div>` : '';
            
            const formattedDate = getFormattedDateAdded(codeData);
            const dateAddedHtml = formattedDate ? `<div class="date-added">Added Here On : ${formattedDate}</div>` : '';
            
            // --- NEW LOGIC STARTS HERE ---
            // Check for the showCopyButton property, defaulting to true if it's missing.
            const hasCopyButton = codeData.showCopyButton !== false;
            let copyButtonHtml = ''; // Create an empty placeholder

            // Only create the button HTML if hasCopyButton is true.
            if (hasCopyButton) {
                copyButtonHtml = `
                    <button class="expired-copy-btn" onclick="copyToClipboard('${codeData.code}', ${index}, 'expired')">
                        COPY
                    </button>
                    <span id="copied-expired-${index}" class="copied-message">✓ Copied!</span>
                `;
            }
            // --- NEW LOGIC ENDS HERE ---
            
            let previewButtonHtml = '';
            if (hasPreviewButton && codeData.imagePreview) { 
                previewButtonHtml = `<button class="exppreview-btn" onclick="openImagePreview('${codeData.imagePreview}')">📷 PREVIEW</button>`;
            }
            
            let expiresDate;
            try {
                expiresDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                if (isNaN(expiresDate.getTime())) { expiresDate = new Date(); }
            } catch (e) {
                expiresDate = new Date();
            }

            return `
                <div class="expired-code-box ${redeemedClass}" id="expired-${index}">
                    <div class="code-header">
                        ${iconHtml}
                        <div class="title-container">${codeData.title}</div>
                    </div>
                    
                    ${dateAddedHtml}
                    ${descriptionHtml}
                    
                    <div class="code-text">${codeData.code}</div>
                    <div class="expire-date">Expired: ${formatDate(expiresDate)}</div>
                    <div class="code-footer">
                        <div class="redeem-checkbox">
                            <input type="checkbox" id="expired-redeemed-${index}" ${isRedeemed ? 'checked' : ''} 
                                onchange="handleRedemptionChange('${codeData.code}', this, document.getElementById('expired-${index}'))">
                            <label for="expired-redeemed-${index}">👎</label>
                        </div>
                        <div class="active-code-buttons-group">
                            ${previewButtonHtml} 
                            
                            <!-- Use the new variable which is either the button or an empty string -->
                            ${copyButtonHtml}
                            
                        </div>
                    </div>
                    <div class="expired-text">❌ EXPIRED</div>
                </div>
            `;
        }

        function updateCountdowns() {
            const now = new Date();
            const nowTimestamp = now.getTime();
            
            // Update active codes
            const activeContainers = document.querySelectorAll('#active-codes-container .code-box');
            activeContainers.forEach((container) => {
                const countdownElement = container.querySelector('.countdown');
                const codeTextElement = container.querySelector('.code-text');
                
                if (!countdownElement || !codeTextElement) return;
                
                const codeText = codeTextElement.textContent;
                // Find the correct code data from ALL_CODES_CONFIG (excluding the vendor for this loop)
                const codeData = ALL_CODES_CONFIG.find(code => code.code === codeText);
                
                // Skip if no codeData or expires found
                if (!codeData || !codeData.expires) {
                    return;
                }
                
                let expireDate;
                try {
                    expireDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                    if (isNaN(expireDate.getTime())) {
                        console.error("Invalid expires date in updateCountdowns (active) for:", codeData.code, codeData.expires);
                        countdownElement.textContent = 'Invalid Date';
                        countdownElement.style.color = '#ff4444';
                        return;
                    }
                } catch (e) {
                    console.error("Error parsing expires date in updateCountdowns (active) for:", codeData.code, codeData.expires, e);
                    countdownElement.textContent = 'Error Date';
                    countdownElement.style.color = '#ff4444';
                    return;
                }

                const timeLeft = expireDate.getTime() - nowTimestamp;
                
                if (timeLeft <= 0) {
                    countdownElement.textContent = 'EXPIRED';
                    countdownElement.style.color = '#ff4444';
                    // Note: This only updates the text. To *move* the box, you'd need more complex DOM manipulation
                    // or re-initialize the page which happens on a full refresh.
                } else {
                    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                    
                    countdownElement.textContent = `Time left: ${days}d ${hours}h ${minutes}m ${seconds}s`;
                    countdownElement.style.color = '#ff7c00';
                }
            });
            
            // Update permanent codes countdowns
            const permanentContainers = document.querySelectorAll('#permanent-codes-container .permanent-code-box');
            permanentContainers.forEach((container) => {
                const countdownElement = container.querySelector('.countdown');
                const codeTextElement = container.querySelector('.permanent-code-text');
                
                if (!countdownElement || !codeTextElement) return;
                
                const codeText = codeTextElement.textContent;
                const codeData = PERMANENT_CODES.find(code => code.code === codeText);
                
                if (!codeData || !codeData.expires) {
                    // If permanent code has no expiration or it's not found, clear countdown if present
                    if (countdownElement) countdownElement.textContent = ''; 
                    return;
                }
                
                let expireDate;
                try {
                    expireDate = (codeData.expires instanceof Date) ? codeData.expires : new Date(codeData.expires);
                    if (isNaN(expireDate.getTime())) {
                        console.error("Invalid expires date in updateCountdowns (permanent) for:", codeData.code, codeData.expires);
                        countdownElement.textContent = 'Invalid Date';
                        countdownElement.style.color = '#ff4444';
                        return;
                    }
                } catch (e) {
                    console.error("Error parsing expires date in updateCountdowns (permanent) for:", codeData.code, codeData.expires, e);
                    countdownElement.textContent = 'Error Date';
                    countdownElement.style.color = '#ff4444';
                    return;
                }

                const timeLeft = expireDate.getTime() - nowTimestamp;
                
                if (timeLeft <= 0) {
                    countdownElement.textContent = 'EXPIRED';
                    countdownElement.style.color = '#ff4444';
                } else {
                    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                    
                    countdownElement.textContent = `Time left: ${days}d ${hours}h ${minutes}m ${seconds}s`;
                    countdownElement.style.color = '#ff7c00';
                }
            });
        }

        // ==================== AUTO CACHE DETECTION ====================
function getCodesHash() {
    // Include all code configs and the Black Market vendor's next refresh time
    const allCodesData = [...ALL_CODES_CONFIG, ...PERMANENT_CODES]; 
    const hashString = allCodesData.map(code => 
code.code + (code.expires ? (new Date(code.expires).getTime() || '') : '') + (code.dateAdded || '')
    ).join('|');

    // Add the next vendor refresh time to the hash to ensure refresh on vendor change
    const nextVendorRefreshTimestamp = getNextVendorRefresh().getTime();
    return btoa(hashString + `|VendorRefresh:${nextVendorRefreshTimestamp}`).substring(0, 32); 
}

        function checkCodesVersion() {
            const currentHash = getCodesHash();
            const savedHash = localStorage.getItem('shiftCodesHash');
            
            if (savedHash !== currentHash) {
                // Codes have changed - update and refresh
                localStorage.setItem('shiftCodesHash', currentHash);
                console.log('Codes updated, refreshing page...');
                location.reload();
                return true; // Page will refresh
            }
            
            return false; // No changes, continue normally
        }

function initializePage() {
    const permanentContainer = document.getElementById('permanent-codes-container');
    const activeContainer = document.getElementById('active-codes-container');
    const expiredContainer = document.getElementById('expired-codes-container');
    const blackMarketContainer = document.getElementById('black-market-codes-container'); 
    
    // Clear all containers to prevent duplicates
    permanentContainer.innerHTML = '';
    activeContainer.innerHTML = '';
    expiredContainer.innerHTML = '';
    blackMarketContainer.innerHTML = '';

    const { regularActiveCodes, permanentActiveCodes, expiredCodes } = organizeCodes();
    
    // --- THIS IS THE CORRECTED LOGIC ---
    // It now loops through your BLACK_MARKET_VENDORS array
    if (BLACK_MARKET_VENDORS && BLACK_MARKET_VENDORS.length > 0) {
        BLACK_MARKET_VENDORS.forEach((vendorData, index) => {
            blackMarketContainer.innerHTML += createBlackMarketVendorBox(vendorData, index);
        });
    } else {
        blackMarketContainer.innerHTML = '<div class="no-codes">Black Market Vendor information is currently unavailable.</div>';
    }
    // --- END OF CORRECTION ---
    
    // Render active codes
    if (regularActiveCodes.length > 0) {
        regularActiveCodes.forEach((codeData, index) => {
            activeContainer.innerHTML += createActiveCodeBox(codeData, index);
        });
    } else {
        activeContainer.innerHTML += '<div class="no-codes">No active regular codes at the moment. Check back later, Vault Hunter!</div>';
    }
    
    // Render permanent codes
    if (permanentActiveCodes.length > 0) {
        permanentActiveCodes.forEach((codeData, index) => {
            permanentContainer.innerHTML += createPermanentCodeBox(codeData, index);
        });
    } else {
        permanentContainer.innerHTML += '<div class="no-codes">No permanent codes available at this time.</div>';
    }
    
    // Render expired codes
    if (expiredCodes.length > 0) {
        expiredCodes.forEach((codeData, index) => {
            expiredContainer.innerHTML += createExpiredCodeBox(codeData, index);
        });
    } else {
        expiredContainer.innerHTML += '<div class="no-codes">No expired codes to display.</div>';
    }

        setupOptionalButtons();
    
    updateCountdowns(); // Initial call
    setInterval(updateCountdowns, 1000); 
    // The separate updateVendorTimer is already running from its own setInterval, which is fine.

    applyDisplayPreferences();
}

        document.addEventListener('DOMContentLoaded', () => {
            // Run version check, if codes changed, page will reload.
            // If not, initializePage will be called.
            if (!checkCodesVersion()) {
                initializePage();
            }
            // Start countdowns and vendor timer once, they manage their own intervals.
            // updateCountdowns is called by initializePage.
            // updateVendorTimer has its own setInterval.
        });

        // --- NEW: Functions for User Display Preferences ---
        function saveDisplayPreference(elementId, isHidden) {
            try {
                const preferences = JSON.parse(localStorage.getItem('userDisplayPreferences')) || {};
                preferences[elementId] = isHidden; // Store true if hidden, false if visible
                localStorage.setItem('userDisplayPreferences', JSON.stringify(preferences));
            } catch (e) {
                console.error("Error saving display preference to localStorage:", e);
            }
        }

        function getDisplayPreference(elementId) {
            try {
                const preferences = JSON.parse(localStorage.getItem('userDisplayPreferences')) || {};
                // Default to false (not hidden) if no preference is saved
                return preferences[elementId] || false; 
            } catch (e) {
                console.error("Error reading display preference from localStorage:", e);
                return false;
            }
        }

        function applyDisplayPreferences() {
            const controlledElements = ['settings-toggle-btn', 'redeem-toggle-btn', 'roadmap-btn', 'maurices-toggle-btn', 'permanent-toggle-btn'];

            controlledElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    const isHidden = getDisplayPreference(id);
                    element.classList.toggle('hidden', isHidden); // Add/remove 'hidden' class
                    
                    // Also update the state of the checkbox in the settings panel
                    const checkbox = document.getElementById(`hide-${id}`);
                    if (checkbox) {
                        checkbox.checked = isHidden;
                    }
                }
            });
        }

        function handleSettingChange(elementId, isHidden) {
            saveDisplayPreference(elementId, isHidden);
            applyDisplayPreferences(); // Re-apply all preferences immediately
        }
        // -- END NEW FUNCTIONS --

    </script>
</body>
</html>
